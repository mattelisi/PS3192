<!DOCTYPE html>
<html lang="en"><head>
<script src="supervised_files/libs/clipboard/clipboard.min.js"></script>
<script src="supervised_files/libs/quarto-html/tabby.min.js"></script>
<script src="supervised_files/libs/quarto-html/popper.min.js"></script>
<script src="supervised_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="supervised_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="supervised_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="supervised_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="supervised_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Matteo Lisi">
  <title>PS3192: Data science for psychology</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="supervised_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="supervised_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="supervised_files/libs/revealjs/dist/theme/quarto.css">
  <link href="supervised_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="supervised_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="supervised_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="supervised_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">PS3192: Data science for psychology</h1>
  <p class="subtitle"><br></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Matteo Lisi 
</div>
</div>
</div>

</section>
<section>
<section id="supervised-learning-classification" class="title-slide slide level1 inverse center" data-background-color="#EB641E">
<h1>Supervised learning &amp; classification</h1>

</section>
<section id="supervised-learning" class="slide level2">
<h2>Supervised learning</h2>
<p>Learn from examples in order to make predictions that generalise to new data.</p>
<p>&nbsp;</p>
<div class="fragment">
<p><strong>Supervised Learning</strong><br>
- We have a <em>training</em> dataset containing some with input features (predictors) <span class="math inline">\(X\)</span> and target labels/outcomes <span class="math inline">\(y\)</span><br>
- The algorithm learns a function <span class="math inline">\(f(X)\)</span> that predicts <span class="math inline">\(y\)</span> accurately<br>
- Learning is achieved by minimising a <em>cost</em> or <em>loss</em> function (i.e.&nbsp;an error metric that tells us how bad the predictions are compared to the observed <span class="math inline">\(y\)</span>)<br>
</p>
</div>
</section>
<section id="woes-of-supervised-learning" class="slide level2">
<h2>Woes of supervised learning</h2>
<ul>
<li class="fragment"><strong>Overfitting</strong>: when the model learns aspects of the training data that are just “noise” and fail to predict well new data.
<ul>
<li class="fragment">It can be due to having a model that is too complex (too many free parameter).</li>
<li class="fragment">Methods like <em>cross-validation</em>, and splitting in training/test sets, help monitoring and reducing the chance of overfitting.</li>
<li class="fragment">If we care about estimating the predictive performance of our model, we need to be careful about leakage of information from test data.</li>
<li class="fragment"><em>Regularisation</em> methods modify the cost function of our model, to favour simpler models and reduce the chance of overfitting.</li>
</ul></li>
<li class="fragment"><strong>Dataset bias</strong>: when the training data is incomplete or systematically different from the broader set of future data that we would like to predict.</li>
</ul>
</section>
<section id="linear-regression-as-a-supervised-ml-algorithm" class="slide level2 scrollable">
<h2>Linear regression as a supervised ML algorithm</h2>
<div class="fragment">
<p>Model: <span class="math display">\[\hat y = \beta_0 + \beta_1 X_1 + \ldots + \beta_k X_k\]</span></p>
</div>
<div class="fragment">
<p>Residuals errors: <span class="math display">\[\epsilon_i = y_i - \hat y_i\]</span></p>
</div>
<div class="fragment">
<p>The <em>loss</em> function is the mean squared error: <span class="math display">\[\text{Loss} = \underbrace{\frac{1}{n}\sum_{i=1}^n ( y_i - \hat y_i)^2}_{\text{mean squared error}} \]</span></p>
</div>
<!-- ::: fragment -->
<!-- In *regularised* regression the loss function is augmented with a *penalty* term, defined as a function of the regression coefficients $\boldsymbol{\beta}=\{\beta_0, \beta_1, \ldots, \beta_k\}$ -->
<!-- $$\text{Loss} = \underbrace{\frac{1}{n} \sum_{i=1}^{n} \left(y_i - \hat y_i \right)^2}_{\text{mean squared error}} \, + \, \underbrace{\lambda \left[ \alpha \sum |\boldsymbol{\beta}| + (1-\alpha) \sum \boldsymbol{\beta}^2 \right]}_{\text{penalty}}$$ -->
<!-- ::: -->
</section>
<section id="logistic-regression-as-a-supervised-ml-algorithm" class="slide level2 scrollable">
<h2>Logistic regression as a supervised ML algorithm</h2>
<div class="fragment">
<p>Model (predicting a probability): <span class="math display">\[
\hat p_i = P(y_i = 1 \mid \mathbf X_i)
= \sigma(\beta_0 + \beta_1 X_{i1} + \ldots + \beta_k X_{ik})
\]</span></p>
<p>where <span class="math display">\[
\sigma(z) = \frac{1}{1 + e^{-z}}
\]</span></p>
</div>
<div class="fragment">
<p>Observed outcome: <span class="math display">\[
y_i \in \{0,1\}
\]</span></p>
<p>We compare the predicted probability <span class="math inline">\(\hat p_i\)</span> to the true class <span class="math inline">\(y_i\)</span>.</p>
</div>
<p>&nbsp;</p>
<div class="fragment">
<p><em>Cross-entropy</em> loss function <span class="math display">\[
\text{Cross-entropy}
= -\frac{1}{n}\sum_{i=1}^n \Big[ y_i \log(\hat p_i)
+ (1 - y_i)\log(1 - \hat p_i) \Big]
\]</span></p>
</div>
</section>
<section id="classification" class="slide level2">
<h2>Classification</h2>
<ul>
<li class="fragment"><p>Linear regression require a continuous outcome variables; however in many real world problems our target variables is a categorical label.</p></li>
<li class="fragment"><p>If the label can only take one of two values (like a coin flip) then we can model our data using logistic regression.</p></li>
<li class="fragment"><p>Dataset with &gt;2 labels requires different approaches.</p></li>
</ul>
</section></section>
<section>
<section id="decision-trees" class="title-slide slide level1 inverse center" data-background-color="#EB641E">
<h1>Decision trees</h1>

</section>
<section id="decision-trees-1" class="slide level2">
<h2>Decision trees</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-2-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="decision-trees-basic-ideas" class="slide level2">
<h2>Decision trees: basic ideas</h2>
<ul>
<li class="fragment"><p>Decision trees <em>split</em> the data multiple times according to certain cutoff values in the features/predictors.</p></li>
<li class="fragment"><p>Starting from the <em>root</em> node each subsequent node in the tree implements further split of the data; subsequent splits are connected by AND logical connectives<br>
(<em>if feature</em> <span class="math inline">\(X\)</span> is [smaller/bigger] than threshold AND … then the predicted class is …)</p></li>
<li class="fragment"><p>The splits create a partition of the data into a set of distinct, non-overlapping regions (high-dimensional rectangles or <em>boxes</em>), each aiming to contains instances of the same class.</p></li>
<li class="fragment"><p>The terminal nodes are also known as <em>leafs</em></p></li>
</ul>
</section>
<section id="section" class="slide level2 smaller scrollable" data-transition="slide">
<h2></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-3-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
<!-- ##  {.smaller .scrollable transition="slide"} -->
<!-- ```{r} -->
<!-- #| fig-height: 6 -->
<!-- #| fig-width: 7 -->
<!-- #| fig-align: center -->
<!-- # Remove missing values -->
<!-- penguins <- na.omit(penguins) -->
<!-- # Fit a simple decision tree (pruned for clarity) -->
<!-- p_m <- rpart(species ~ flipper_length_mm + bill_length_mm, data = penguins, method = "class") -->
<!-- # Convert to party object for better visualization -->
<!-- p_m2 <- as.party(p_m) -->
<!-- # Create a grid of values for flipper length and bill length -->
<!-- flipper_seq <- seq(min(penguins$flipper_length_mm)-10, max(penguins$flipper_length_mm)+10, length.out = 200) -->
<!-- bill_seq <- seq(min(penguins$bill_length_mm)-5, max(penguins$bill_length_mm)+5, length.out = 200) -->
<!-- grid <- expand.grid( -->
<!--   flipper_length_mm = flipper_seq, -->
<!--   bill_length_mm = bill_seq -->
<!-- ) -->
<!-- # Predict species for each grid point -->
<!-- grid$species <- predict(p_m, newdata = grid, type = "class") -->
<!-- # Plot the decision boundaries -->
<!-- ggplot() + -->
<!--   geom_tile(data = grid, aes(x = flipper_length_mm, y = bill_length_mm, fill = species), alpha = 0.8) + -->
<!--   geom_point(data = penguins, aes(x = flipper_length_mm, y = bill_length_mm, color = species), pch=21, size = 2) + -->
<!--   labs( -->
<!--     x = "Flipper length (mm)", -->
<!--     y = "Bill length (mm)", -->
<!--     title = "Decision boundaries" -->
<!--   ) + -->
<!--   scale_fill_manual(values = c("Adelie" = "lightblue", "Chinstrap" = "lightgreen", "Gentoo" = "lightpink")) + -->
<!--   scale_color_manual(values = c("Adelie" = "blue", "Chinstrap" = "dark green", "Gentoo" = "red")) + -->
<!--   theme_minimal()+ -->
<!--   coord_cartesian(xlim=range(penguins$flipper_length_mm),ylim=range(penguins$bill_length_mm)) -->
<!-- ``` -->
</section>
<section id="section-1" class="slide level2 smaller scrollable" data-transition="slide">
<h2></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-4-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="growing-a-decision-tree" class="slide level2 scrollable">
<h2>Growing a decision tree</h2>
<p>How do we choose the split? The most popular approach is <strong>recursive binary splitting</strong>, a <em>top-down, greedy</em> algorithm:</p>
<div style="font-size: 80%;">
<ul>
<li class="fragment"><em>top-down</em> because it starts at the top of the tree</li>
<li class="fragment"><em>greedy</em> because it works by optimising the splits <em>locally</em>, at each node sequentially, rather than all the splits at once.</li>
</ul>
</div>
<ol type="1">
<li class="fragment">Start with a dataset having features <span class="math inline">\(X\)</span> and class labels <span class="math inline">\(y = \left\{ 1, \ldots, k\right\}\)</span></li>
<li class="fragment">Choose a feature (say <span class="math inline">\(X_j\)</span>) and a <strong>threshold</strong> <span class="math inline">\(t\)</span> that best <strong>splits</strong> the data into two subsets, depending on whether <span class="math inline">\(\{x_j \le t \}\)</span> or <span class="math inline">\(\{x_j &gt; t \}\)</span>.<br>
The <strong>best split</strong> is the one that minimizes an <strong>impurity measure</strong> in child nodes.</li>
</ol>
<div style="font-size: 80%;">
<ul>
<li class="fragment">Common impurity measure: <strong>Gini index</strong>: <span class="math inline">\(G = 1 - \sum_{k=1}^K p_k^2\)</span></li>
<li class="fragment">Here, <span class="math inline">\(p_k\)</span> is the proportion of class <span class="math inline">\(k\)</span> instances in a node.</li>
<li class="fragment">Gini index is small if all values are close to 0 or 1.</li>
</ul>
</div>
<ol start="3" type="1">
<li class="fragment"><strong>Repeat</strong> recursively (by splitting one of the previously identified nodes) until some stopping criterion (e.g., max depth, n.&nbsp;of datapoints per leaf) is met.</li>
</ol>
</section>
<section id="pruning-the-tree" class="slide level2">
<h2>Pruning the tree</h2>
<ul>
<li class="fragment"><p><strong>The tree-growing algorithm is likely to <em>overfit</em> the training data</strong>, producing too complex trees that may not generalise well to new data.</p></li>
<li class="fragment"><p>One could grow the tree only as long as the decrease in the impurity measure due to each split exceeds a relatively high threshold.&nbsp; However this is too short-sighted — a seemingly worthless split early on in the tree might be followed by a very good split.</p></li>
<li class="fragment"><p>A better strategy is to <strong>grow a large tree, and then <em>prune</em> it back to a smaller <em>sub</em>-tree</strong>, by removing leaf nodes that add little predictive value.</p></li>
</ul>
<p>&nbsp;</p>
<ul>
<li class="fragment">In practice pruning works as follow:
<ol type="1">
<li class="fragment">set a tuning parameter <span class="math inline">\(\alpha\)</span> penalizes the loss function based on complexity (number of leaf nodes).</li>
<li class="fragment">use cross-validation to select a best value for <span class="math inline">\(\alpha\)</span></li>
</ol></li>
</ul>
</section>
<section id="section-2" class="slide level2">
<h2></h2>
<p><em>Unpruned</em> tree for <code>penguins</code> data</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center" width="1248"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-3" class="slide level2">
<h2></h2>
<p>Pruning the tree via cross-validation</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-4" class="slide level2">
<h2></h2>
<h3 id="estimating-a-decision-tree-in-r-rpart-package">Estimating a decision tree in R (<code>rpart</code> package)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb1-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="" aria-hidden="true" tabindex="-1"></a>p_m <span class="ot">&lt;-</span> <span class="fu">rpart</span>(species<span class="sc">~</span> ., <span class="at">data =</span> penguins)</span>
<span id="cb1-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="" aria-hidden="true" tabindex="-1"></a>p_m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>n= 333 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

1) root 333 187 Adelie (0.438438438 0.204204204 0.357357357)  
  2) flipper_length_mm&lt; 206.5 208  64 Adelie (0.692307692 0.302884615 0.004807692)  
    4) bill_length_mm&lt; 43.35 145   5 Adelie (0.965517241 0.034482759 0.000000000) *
    5) bill_length_mm&gt;=43.35 63   5 Chinstrap (0.063492063 0.920634921 0.015873016) *
  3) flipper_length_mm&gt;=206.5 125   7 Gentoo (0.016000000 0.040000000 0.944000000)  
    6) island=Dream,Torgersen 7   2 Chinstrap (0.285714286 0.714285714 0.000000000) *
    7) island=Biscoe 118   0 Gentoo (0.000000000 0.000000000 1.000000000) *</code></pre>
</div>
</div>
<div class="fragment">
<p>&nbsp;</p>
<div style="font-size: 80%;">
<p>This tree has only 4 terminal leafs (terminal nodes).<br>
This is because by default <code>rpart</code> does not attempt to split a node if it has 20 datapoints or less.</p>
</div>
</div>
</section>
<section id="section-5" class="slide level2">
<h2></h2>
<p>We can change parameters to allows smaller splits:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="" aria-hidden="true" tabindex="-1"></a>p_m <span class="ot">&lt;-</span> <span class="fu">rpart</span>(species<span class="sc">~</span> ., <span class="at">data =</span> penguins,</span>
<span id="cb3-2"><a href="" aria-hidden="true" tabindex="-1"></a>             <span class="at">minsplit =</span> <span class="dv">4</span>,  <span class="co"># minumun N in a node to attempt a split</span></span>
<span id="cb3-3"><a href="" aria-hidden="true" tabindex="-1"></a>             <span class="at">xval=</span><span class="dv">50</span>)       <span class="co"># N. of cross-validations</span></span>
<span id="cb3-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="" aria-hidden="true" tabindex="-1"></a>p_m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>n= 333 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

 1) root 333 187 Adelie (0.438438438 0.204204204 0.357357357)  
   2) flipper_length_mm&lt; 206.5 208  64 Adelie (0.692307692 0.302884615 0.004807692)  
     4) bill_length_mm&lt; 43.35 145   5 Adelie (0.965517241 0.034482759 0.000000000)  
       8) bill_length_mm&lt; 42.35 134   1 Adelie (0.992537313 0.007462687 0.000000000) *
       9) bill_length_mm&gt;=42.35 11   4 Adelie (0.636363636 0.363636364 0.000000000)  
        18) bill_depth_mm&gt;=17.45 7   0 Adelie (1.000000000 0.000000000 0.000000000) *
        19) bill_depth_mm&lt; 17.45 4   0 Chinstrap (0.000000000 1.000000000 0.000000000) *
     5) bill_length_mm&gt;=43.35 63   5 Chinstrap (0.063492063 0.920634921 0.015873016)  
      10) island=Biscoe,Torgersen 4   1 Adelie (0.750000000 0.000000000 0.250000000) *
      11) island=Dream 59   1 Chinstrap (0.016949153 0.983050847 0.000000000) *
   3) flipper_length_mm&gt;=206.5 125   7 Gentoo (0.016000000 0.040000000 0.944000000)  
     6) island=Dream,Torgersen 7   2 Chinstrap (0.285714286 0.714285714 0.000000000)  
      12) bill_length_mm&lt; 46.55 2   0 Adelie (1.000000000 0.000000000 0.000000000) *
      13) bill_length_mm&gt;=46.55 5   0 Chinstrap (0.000000000 1.000000000 0.000000000) *
     7) island=Biscoe 118   0 Gentoo (0.000000000 0.000000000 1.000000000) *</code></pre>
</div>
</div>
<div class="fragment">
<div style="font-size: 80%;">
<p>Now the tree has 8 leafs (which correspond to the minimum of the cross-validation error as shown in the cross-validation plot)</p>
</div>
</div>
</section>
<section id="section-6" class="slide level2">
<h2></h2>
<div style="font-size: 80%;">
<ul>
<li class="fragment">In practice we may want to choose the simplest model that is within 1 standard error from the minimum, rather than the minimum itself.</li>
<li class="fragment">(The error typically shows a sharp drop followed by a flat plateau; so the 1 - SE rule allows to choose the simplest model among all those “tied” on the plateau)</li>
</ul>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-9-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-7" class="slide level2">
<h2></h2>
<p>Tree for <code>penguins</code> data, after allowing split also in nodes with as little as <code>minsplit = 4</code> observations.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center" width="1248"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-8" class="slide level2 scrollable">
<h2></h2>
<p>We can print on the console the cross-validation results using the <code>printcp()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(p_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Classification tree:
rpart(formula = species ~ ., data = penguins, minsplit = 4, xval = 50)

Variables actually used in tree construction:
[1] bill_depth_mm     bill_length_mm    flipper_length_mm island           

Root node error: 187/333 = 0.56156

n= 333 

        CP nsplit rel error   xerror     xstd
1 0.620321      0  1.000000 1.000000 0.048421
2 0.288770      1  0.379679 0.385027 0.040172
3 0.026738      2  0.090909 0.117647 0.024240
4 0.016043      3  0.064171 0.085561 0.020870
5 0.010695      4  0.048128 0.080214 0.020239
6 0.010000      7  0.016043 0.069519 0.018901</code></pre>
</div>
</div>
<p>&nbsp;</p>
<div class="fragment">
<p>We can manually prune the tree at any value we may want. e.g.&nbsp;if we decide that 4 splits are preferable, as its error is close to the best model, we can prune the tree using</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">prune</span>(p_m, <span class="at">cp=</span><span class="fl">0.011</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>n= 333 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

 1) root 333 187 Adelie (0.438438438 0.204204204 0.357357357)  
   2) flipper_length_mm&lt; 206.5 208  64 Adelie (0.692307692 0.302884615 0.004807692)  
     4) bill_length_mm&lt; 43.35 145   5 Adelie (0.965517241 0.034482759 0.000000000) *
     5) bill_length_mm&gt;=43.35 63   5 Chinstrap (0.063492063 0.920634921 0.015873016)  
      10) island=Biscoe,Torgersen 4   1 Adelie (0.750000000 0.000000000 0.250000000) *
      11) island=Dream 59   1 Chinstrap (0.016949153 0.983050847 0.000000000) *
   3) flipper_length_mm&gt;=206.5 125   7 Gentoo (0.016000000 0.040000000 0.944000000)  
     6) island=Dream,Torgersen 7   2 Chinstrap (0.285714286 0.714285714 0.000000000) *
     7) island=Biscoe 118   0 Gentoo (0.000000000 0.000000000 1.000000000) *</code></pre>
</div>
</div>
</div>
</section>
<section id="section-9" class="slide level2 scrollable">
<h2></h2>
<p>The <code>summary()</code> function provides further information</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(p_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
rpart(formula = species ~ ., data = penguins, minsplit = 4, xval = 50)
  n= 333 

          CP nsplit  rel error     xerror       xstd
1 0.62032086      0 1.00000000 1.00000000 0.04842097
2 0.28877005      1 0.37967914 0.38502674 0.04017194
3 0.02673797      2 0.09090909 0.11764706 0.02423973
4 0.01604278      3 0.06417112 0.08556150 0.02087017
5 0.01069519      4 0.04812834 0.08021390 0.02023930
6 0.01000000      7 0.01604278 0.06951872 0.01890092

Variable importance
flipper_length_mm    bill_length_mm     bill_depth_mm       body_mass_g 
               21                21                18                16 
           island           island2 
               14                11 

Node number 1: 333 observations,    complexity param=0.6203209
  predicted class=Adelie     expected loss=0.5615616  P(node) =1
    class counts:   146    68   119
   probabilities: 0.438 0.204 0.357 
  left son=2 (208 obs) right son=3 (125 obs)
  Primary splits:
      flipper_length_mm &lt; 206.5  to the left,  improve=109.97940, (0 missing)
      bill_length_mm    &lt; 42.35  to the left,  improve=102.52910, (0 missing)
      bill_depth_mm     &lt; 16.45  to the right, improve= 96.64493, (0 missing)
      body_mass_g       &lt; 4525   to the left,  improve= 83.06712, (0 missing)
      island            splits as  RLL,        improve= 66.73118, (0 missing)
  Surrogate splits:
      bill_depth_mm  &lt; 16.35  to the right, agree=0.931, adj=0.816, (0 split)
      body_mass_g    &lt; 4525   to the left,  agree=0.907, adj=0.752, (0 split)
      island         splits as  RLL,        agree=0.844, adj=0.584, (0 split)
      island2        splits as  RL,         agree=0.844, adj=0.584, (0 split)
      bill_length_mm &lt; 43.25  to the left,  agree=0.784, adj=0.424, (0 split)

Node number 2: 208 observations,    complexity param=0.2887701
  predicted class=Adelie     expected loss=0.3076923  P(node) =0.6246246
    class counts:   144    63     1
   probabilities: 0.692 0.303 0.005 
  left son=4 (145 obs) right son=5 (63 obs)
  Primary splits:
      bill_length_mm    &lt; 43.35  to the left,  improve=70.232650, (0 missing)
      island            splits as  LRL,        improve=29.089290, (0 missing)
      island2           splits as  LR,         improve= 9.964985, (0 missing)
      flipper_length_mm &lt; 192.5  to the left,  improve= 8.887353, (0 missing)
      body_mass_g       &lt; 3225   to the left,  improve= 2.340859, (0 missing)
  Surrogate splits:
      flipper_length_mm &lt; 195.5  to the left,  agree=0.740, adj=0.143, (0 split)
      island            splits as  LRL,        agree=0.702, adj=0.016, (0 split)

Node number 3: 125 observations,    complexity param=0.02673797
  predicted class=Gentoo     expected loss=0.056  P(node) =0.3753754
    class counts:     2     5   118
   probabilities: 0.016 0.040 0.944 
  left son=6 (7 obs) right son=7 (118 obs)
  Primary splits:
      island         splits as  RLL,        improve=10.518860, (0 missing)
      bill_depth_mm  &lt; 17.65  to the right, improve=10.518860, (0 missing)
      island2        splits as  RL,         improve=10.518860, (0 missing)
      body_mass_g    &lt; 4125   to the left,  improve= 4.692667, (0 missing)
      bill_length_mm &lt; 40.85  to the left,  improve= 1.876000, (0 missing)
  Surrogate splits:
      bill_depth_mm &lt; 17.65  to the right, agree=1.000, adj=1.000, (0 split)
      body_mass_g   &lt; 4125   to the left,  agree=0.968, adj=0.429, (0 split)

Node number 4: 145 observations,    complexity param=0.01069519
  predicted class=Adelie     expected loss=0.03448276  P(node) =0.4354354
    class counts:   140     5     0
   probabilities: 0.966 0.034 0.000 
  left son=8 (134 obs) right son=9 (11 obs)
  Primary splits:
      bill_length_mm    &lt; 42.35  to the left,  improve=2.5791890, (0 missing)
      bill_depth_mm     &lt; 16.75  to the right, improve=1.0019550, (0 missing)
      flipper_length_mm &lt; 187.5  to the right, improve=0.5480296, (0 missing)
      island            splits as  LRL,        improve=0.5172414, (0 missing)
      body_mass_g       &lt; 3375   to the right, improve=0.4548910, (0 missing)
  Surrogate splits:
      body_mass_g &lt; 4687.5 to the left,  agree=0.931, adj=0.091, (0 split)

Node number 5: 63 observations,    complexity param=0.01604278
  predicted class=Chinstrap  expected loss=0.07936508  P(node) =0.1891892
    class counts:     4    58     1
   probabilities: 0.063 0.921 0.016 
  left son=10 (4 obs) right son=11 (59 obs)
  Primary splits:
      island         splits as  LRL,        improve=5.867232, (0 missing)
      body_mass_g    &lt; 4125   to the right, improve=2.833333, (0 missing)
      island2        splits as  RL,         improve=2.628415, (0 missing)
      bill_depth_mm  &lt; 15.4   to the right, improve=1.849462, (0 missing)
      bill_length_mm &lt; 46.05  to the left,  improve=1.659864, (0 missing)
  Surrogate splits:
      body_mass_g &lt; 4575   to the right, agree=0.968, adj=0.5, (0 split)
      island2     splits as  LR,         agree=0.968, adj=0.5, (0 split)

Node number 6: 7 observations,    complexity param=0.01069519
  predicted class=Chinstrap  expected loss=0.2857143  P(node) =0.02102102
    class counts:     2     5     0
   probabilities: 0.286 0.714 0.000 
  left son=12 (2 obs) right son=13 (5 obs)
  Primary splits:
      bill_length_mm    &lt; 46.55  to the left,  improve=2.8571430, (0 missing)
      bill_depth_mm     &lt; 18.95  to the left,  improve=2.8571430, (0 missing)
      island            splits as  -RL,        improve=1.1904760, (0 missing)
      flipper_length_mm &lt; 209    to the left,  improve=0.2571429, (0 missing)
      body_mass_g       &lt; 3975   to the right, improve=0.1904762, (0 missing)
  Surrogate splits:
      bill_depth_mm &lt; 18.95  to the left,  agree=1, adj=1, (0 split)

Node number 7: 118 observations
  predicted class=Gentoo     expected loss=0  P(node) =0.3543544
    class counts:     0     0   118
   probabilities: 0.000 0.000 1.000 

Node number 8: 134 observations
  predicted class=Adelie     expected loss=0.007462687  P(node) =0.4024024
    class counts:   133     1     0
   probabilities: 0.993 0.007 0.000 

Node number 9: 11 observations,    complexity param=0.01069519
  predicted class=Adelie     expected loss=0.3636364  P(node) =0.03303303
    class counts:     7     4     0
   probabilities: 0.636 0.364 0.000 
  left son=18 (7 obs) right son=19 (4 obs)
  Primary splits:
      bill_depth_mm     &lt; 17.45  to the right, improve=5.090909, (0 missing)
      flipper_length_mm &lt; 189.5  to the right, improve=5.090909, (0 missing)
      sex               splits as  RL,         improve=5.090909, (0 missing)
      island            splits as  LRL,        improve=3.490909, (0 missing)
      body_mass_g       &lt; 3837.5 to the right, improve=3.490909, (0 missing)
  Surrogate splits:
      flipper_length_mm &lt; 189.5  to the right, agree=1.000, adj=1.00, (0 split)
      body_mass_g       &lt; 3425   to the right, agree=0.909, adj=0.75, (0 split)
      bill_length_mm    &lt; 42.6   to the right, agree=0.818, adj=0.50, (0 split)
      year              &lt; 2007.5 to the right, agree=0.727, adj=0.25, (0 split)

Node number 10: 4 observations
  predicted class=Adelie     expected loss=0.25  P(node) =0.01201201
    class counts:     3     0     1
   probabilities: 0.750 0.000 0.250 

Node number 11: 59 observations
  predicted class=Chinstrap  expected loss=0.01694915  P(node) =0.1771772
    class counts:     1    58     0
   probabilities: 0.017 0.983 0.000 

Node number 12: 2 observations
  predicted class=Adelie     expected loss=0  P(node) =0.006006006
    class counts:     2     0     0
   probabilities: 1.000 0.000 0.000 

Node number 13: 5 observations
  predicted class=Chinstrap  expected loss=0  P(node) =0.01501502
    class counts:     0     5     0
   probabilities: 0.000 1.000 0.000 

Node number 18: 7 observations
  predicted class=Adelie     expected loss=0  P(node) =0.02102102
    class counts:     7     0     0
   probabilities: 1.000 0.000 0.000 

Node number 19: 4 observations
  predicted class=Chinstrap  expected loss=0  P(node) =0.01201201
    class counts:     0     4     0
   probabilities: 0.000 1.000 0.000 </code></pre>
</div>
</div>
</section>
<section id="section-10" class="slide level2">
<h2></h2>
<p>Notes on <code>summary()</code> output</p>
<ul>
<li class="fragment"><p><strong>Primary vs <em>surrogate</em> splits</strong>: surrogate splits are rules to make decisions when the variables in a split point is missing</p></li>
<li class="fragment"><p><strong>Variable importance</strong> summarise how useful is a variable for prediction (based on unpruned tree and including surrogate splits)</p></li>
</ul>
</section>
<section id="plotting-trees-1" class="slide level2">
<h2>Plotting trees (1)</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">xpd =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_m, <span class="at">compress=</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(p_m, <span class="at">use.n =</span> <span class="cn">TRUE</span>, <span class="at">cex=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-14-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<div style="font-size: 80%;">
<p>See <code>?plot.rpart</code> for available options.</p>
</div>
</section>
<section id="plotting-trees-2" class="slide level2 scrollable" data-transition="convex">
<h2>Plotting trees (2)</h2>
<p>Using the <code>rpart.plot</code> library.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb12-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(p_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-15-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
<div style="font-size: 80%;">
<p>See <code>?rpart.plot</code> for options.</p>
</div>
</section>
<section id="plotting-trees-3" class="slide level2 scrollable" data-transition="convex">
<h2>Plotting trees (3)</h2>
<p>Using the <code>partykit</code> library.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(partykit)</span>
<span id="cb13-2"><a href="" aria-hidden="true" tabindex="-1"></a>p_m2 <span class="ot">&lt;-</span> <span class="fu">as.party</span>(p_m)</span>
<span id="cb13-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p_m2, </span>
<span id="cb13-5"><a href="" aria-hidden="true" tabindex="-1"></a>     <span class="at">terminal_panel =</span>  <span class="fu">node_barplot</span>(p_m2, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">8</span>)),</span>
<span id="cb13-6"><a href="" aria-hidden="true" tabindex="-1"></a>     <span class="at">inner_panel =</span> <span class="fu">node_inner</span>(p_m2, <span class="at">id =</span> <span class="cn">FALSE</span>),</span>
<span id="cb13-7"><a href="" aria-hidden="true" tabindex="-1"></a>     <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-16-1.png" class="quarto-figure quarto-figure-center" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="confusion-matrix" class="slide level2 scrollable">
<h2>Confusion matrix</h2>
<p>A way to examine the accuracy of classification (<em>note that the this would be accuracy on the training set; to assess predictive accuracy for new, unseen data we need to use something like cross-validation</em>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># fit tree</span></span>
<span id="cb14-2"><a href="" aria-hidden="true" tabindex="-1"></a>p_m <span class="ot">&lt;-</span> <span class="fu">rpart</span>(species<span class="sc">~</span> ., <span class="at">data =</span> penguins)</span>
<span id="cb14-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># compute predictions on training set</span></span>
<span id="cb14-5"><a href="" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(p_m, penguins, <span class="at">type =</span> <span class="st">"class"</span>)</span>
<span id="cb14-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># compute confusion matrix</span></span>
<span id="cb14-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb14-9"><a href="" aria-hidden="true" tabindex="-1"></a>conf_mat <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(predictions, penguins<span class="sc">$</span>species)</span>
<span id="cb14-10"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conf_mat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

           Reference
Prediction  Adelie Chinstrap Gentoo
  Adelie       140         5      0
  Chinstrap      6        63      1
  Gentoo         0         0    118

Overall Statistics
                                          
               Accuracy : 0.964           
                 95% CI : (0.9379, 0.9812)
    No Information Rate : 0.4384          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.9437          
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                     Class: Adelie Class: Chinstrap Class: Gentoo
Sensitivity                 0.9589           0.9265        0.9916
Specificity                 0.9733           0.9736        1.0000
Pos Pred Value              0.9655           0.9000        1.0000
Neg Pred Value              0.9681           0.9810        0.9953
Prevalence                  0.4384           0.2042        0.3574
Detection Rate              0.4204           0.1892        0.3544
Detection Prevalence        0.4354           0.2102        0.3544
Balanced Accuracy           0.9661           0.9500        0.9958</code></pre>
</div>
</div>
</section>
<section id="plotting-a-confusion-matrix" class="slide level2">
<h2>Plotting a confusion matrix</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert confusion matrix to a data frame for ggplot</span></span>
<span id="cb16-2"><a href="" aria-hidden="true" tabindex="-1"></a>conf_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(conf_mat<span class="sc">$</span>table)</span>
<span id="cb16-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a heatmap plot</span></span>
<span id="cb16-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(conf_df, <span class="fu">aes</span>(<span class="at">x =</span> Prediction, <span class="at">y =</span> Reference, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb16-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb16-7"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span>  <span class="co"># Add text labels</span></span>
<span id="cb16-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span>  <span class="co"># Color scale</span></span>
<span id="cb16-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Confusion Matrix"</span>,</span>
<span id="cb16-10"><a href="" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predicted Class"</span>,</span>
<span id="cb16-11"><a href="" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Actual Class"</span>) <span class="sc">+</span></span>
<span id="cb16-12"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb16-13"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-18-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="a-more-complex-example-germancredit-dataset" class="slide level2 scrollable">
<h2>A more complex example: <code>GermanCredit</code> dataset</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1000 obs. of  62 variables:
 $ Duration                              : int  6 48 12 42 24 36 24 36 12 30 ...
 $ Amount                                : int  1169 5951 2096 7882 4870 9055 2835 6948 3059 5234 ...
 $ InstallmentRatePercentage             : int  4 2 2 2 3 2 3 2 2 4 ...
 $ ResidenceDuration                     : int  4 2 3 4 4 4 4 2 4 2 ...
 $ Age                                   : int  67 22 49 45 53 35 53 35 61 28 ...
 $ NumberExistingCredits                 : int  2 1 1 1 2 1 1 1 1 2 ...
 $ NumberPeopleMaintenance               : int  1 1 2 2 2 2 1 1 1 1 ...
 $ Telephone                             : num  0 1 1 1 1 0 1 0 1 1 ...
 $ ForeignWorker                         : num  1 1 1 1 1 1 1 1 1 1 ...
 $ Class                                 : Factor w/ 2 levels "Bad","Good": 2 1 2 2 1 2 2 2 2 1 ...
 $ CheckingAccountStatus.lt.0            : num  1 0 0 1 1 0 0 0 0 0 ...
 $ CheckingAccountStatus.0.to.200        : num  0 1 0 0 0 0 0 1 0 1 ...
 $ CheckingAccountStatus.gt.200          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ CheckingAccountStatus.none            : num  0 0 1 0 0 1 1 0 1 0 ...
 $ CreditHistory.NoCredit.AllPaid        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ CreditHistory.ThisBank.AllPaid        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ CreditHistory.PaidDuly                : num  0 1 0 1 0 1 1 1 1 0 ...
 $ CreditHistory.Delay                   : num  0 0 0 0 1 0 0 0 0 0 ...
 $ CreditHistory.Critical                : num  1 0 1 0 0 0 0 0 0 1 ...
 $ Purpose.NewCar                        : num  0 0 0 0 1 0 0 0 0 1 ...
 $ Purpose.UsedCar                       : num  0 0 0 0 0 0 0 1 0 0 ...
 $ Purpose.Furniture.Equipment           : num  0 0 0 1 0 0 1 0 0 0 ...
 $ Purpose.Radio.Television              : num  1 1 0 0 0 0 0 0 1 0 ...
 $ Purpose.DomesticAppliance             : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Purpose.Repairs                       : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Purpose.Education                     : num  0 0 1 0 0 1 0 0 0 0 ...
 $ Purpose.Vacation                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Purpose.Retraining                    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Purpose.Business                      : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Purpose.Other                         : num  0 0 0 0 0 0 0 0 0 0 ...
 $ SavingsAccountBonds.lt.100            : num  0 1 1 1 1 0 0 1 0 1 ...
 $ SavingsAccountBonds.100.to.500        : num  0 0 0 0 0 0 0 0 0 0 ...
 $ SavingsAccountBonds.500.to.1000       : num  0 0 0 0 0 0 1 0 0 0 ...
 $ SavingsAccountBonds.gt.1000           : num  0 0 0 0 0 0 0 0 1 0 ...
 $ SavingsAccountBonds.Unknown           : num  1 0 0 0 0 1 0 0 0 0 ...
 $ EmploymentDuration.lt.1               : num  0 0 0 0 0 0 0 0 0 0 ...
 $ EmploymentDuration.1.to.4             : num  0 1 0 0 1 1 0 1 0 0 ...
 $ EmploymentDuration.4.to.7             : num  0 0 1 1 0 0 0 0 1 0 ...
 $ EmploymentDuration.gt.7               : num  1 0 0 0 0 0 1 0 0 0 ...
 $ EmploymentDuration.Unemployed         : num  0 0 0 0 0 0 0 0 0 1 ...
 $ Personal.Male.Divorced.Seperated      : num  0 0 0 0 0 0 0 0 1 0 ...
 $ Personal.Female.NotSingle             : num  0 1 0 0 0 0 0 0 0 0 ...
 $ Personal.Male.Single                  : num  1 0 1 1 1 1 1 1 0 0 ...
 $ Personal.Male.Married.Widowed         : num  0 0 0 0 0 0 0 0 0 1 ...
 $ Personal.Female.Single                : num  0 0 0 0 0 0 0 0 0 0 ...
 $ OtherDebtorsGuarantors.None           : num  1 1 1 0 1 1 1 1 1 1 ...
 $ OtherDebtorsGuarantors.CoApplicant    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ OtherDebtorsGuarantors.Guarantor      : num  0 0 0 1 0 0 0 0 0 0 ...
 $ Property.RealEstate                   : num  1 1 1 0 0 0 0 0 1 0 ...
 $ Property.Insurance                    : num  0 0 0 1 0 0 1 0 0 0 ...
 $ Property.CarOther                     : num  0 0 0 0 0 0 0 1 0 1 ...
 $ Property.Unknown                      : num  0 0 0 0 1 1 0 0 0 0 ...
 $ OtherInstallmentPlans.Bank            : num  0 0 0 0 0 0 0 0 0 0 ...
 $ OtherInstallmentPlans.Stores          : num  0 0 0 0 0 0 0 0 0 0 ...
 $ OtherInstallmentPlans.None            : num  1 1 1 1 1 1 1 1 1 1 ...
 $ Housing.Rent                          : num  0 0 0 0 0 0 0 1 0 0 ...
 $ Housing.Own                           : num  1 1 1 0 0 0 1 0 1 1 ...
 $ Housing.ForFree                       : num  0 0 0 1 1 1 0 0 0 0 ...
 $ Job.UnemployedUnskilled               : num  0 0 0 0 0 0 0 0 0 0 ...
 $ Job.UnskilledResident                 : num  0 0 1 0 0 1 0 0 1 0 ...
 $ Job.SkilledEmployee                   : num  1 1 0 1 1 0 1 0 0 0 ...
 $ Job.Management.SelfEmp.HighlyQualified: num  0 0 0 0 0 0 0 1 0 1 ...</code></pre>
</div>
</div>
</section>
<section id="section-11" class="slide level2">
<h2></h2>
<p>Estimated decision tree (with pruning)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="" aria-hidden="true" tabindex="-1"></a>credit_tree <span class="ot">&lt;-</span> <span class="fu">rpart</span>(Class  <span class="sc">~</span> ., <span class="at">data =</span> GermanCredit, <span class="at">xval=</span><span class="dv">100</span>)</span>
<span id="cb18-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(credit_tree)</span>
<span id="cb18-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(credit_tree, <span class="at">use.n =</span> <span class="cn">TRUE</span>, <span class="at">cex=</span><span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-20-1.png" class="quarto-figure quarto-figure-center" width="1536"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-12" class="slide level2">
<h2></h2>
<p>Unpruned tree</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="" aria-hidden="true" tabindex="-1"></a>credit_tree <span class="ot">&lt;-</span> <span class="fu">rpart</span>(Class  <span class="sc">~</span> ., <span class="at">data =</span> GermanCredit,</span>
<span id="cb19-2"><a href="" aria-hidden="true" tabindex="-1"></a>                     <span class="at">cp =</span> <span class="dv">0</span>, <span class="at">minsplit =</span> <span class="dv">2</span>)</span>
<span id="cb19-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(credit_tree)</span>
<span id="cb19-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(credit_tree, <span class="at">use.n =</span> <span class="cn">TRUE</span>, <span class="at">cex=</span><span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-21-1.png" class="quarto-figure quarto-figure-center" width="1536"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise" class="slide level2">
<h2>Exercise</h2>
<ul>
<li class="fragment">Use one of the dataset for classification in the ‘coursework’ folder on Moodle and fit a decision tree model.</li>
</ul>
</section>
<section id="section-13" class="slide level2 scrollable">
<h2></h2>
<h4 id="advantages">Advantages</h4>
<ul>
<li class="fragment"><p><strong>Interpretability</strong>: trees are easy to visualize, interpret and explain.</p></li>
<li class="fragment"><p><strong>Flexibility</strong>: trees can easily handle many types of variables; they can also be used for regression (are also known as classification and regression trees, or CART).</p></li>
<li class="fragment"><p><strong>Nonlinear Boundaries</strong>: trees naturally model complex, non-linear relationships.</p></li>
</ul>
<div class="fragment">
<!-- -->
<h4 id="disadvantages">Disadvantages</h4>
<ul>
<li class="fragment"><p>For regression, decision trees approximate linear relationships with <em>piecewise</em> functions, which can be inefficient compared to direct linear modeling. They also lack <em>smoothness</em> — a small change in a feature can push it past a threshold, causing a sudden jump in predictions.</p></li>
<li class="fragment"><p><strong>Non-robust</strong>: a small change in the training data can create a large difference in the final estimated tree<br>
(each split depends on the <em>parent</em> split, and if a different root node is selected the whole tree will be different).</p></li>
</ul>
</div>
</section></section>
<section>
<section id="ensemble-methods" class="title-slide slide level1 inverse center" data-background-color="#EB641E">
<h1>Ensemble methods</h1>

</section>
<section id="ensemble-methods-to-improve-robustness" class="slide level2">
<h2>Ensemble methods to improve robustness</h2>
<ul>
<li class="fragment"><p>Trees suffer from <em>high variance</em>: if we split the training data into two parts at random, and fit a decision tree to both halves, the results that we get could be quite different.</p></li>
<li class="fragment"><p>One approach to improve robustness is <em>bootstrap aggregation</em> or <em>bagging</em>:</p>
<ol type="1">
<li class="fragment">take repeated samples (with replacement) from the training data (<em>bootstrapping</em>)</li>
<li class="fragment">train a tree on each of these <em>bootstrapped</em> dataset</li>
<li class="fragment">combine the predictions (<em>mojority vote</em>)</li>
</ol></li>
<li class="fragment"><p>Bagging can be used to combine together hundreds or thousands of trees in a single procedure, and can give more robust and accurate results.</p></li>
</ul>
</section>
<section id="random-forests" class="slide level2">
<h2>Random forests</h2>
<ul>
<li class="fragment"><p>Random forests provide a further improvements over bagged trees: in addition to resampling the observations (the rows in our data) in each resampled training dataset we include only a subset of the predictor variables.</p></li>
<li class="fragment"><p>This small tweak decorrelate the trees in each resampled dataset and make the ensemble even less variable and more robust.</p></li>
<li class="fragment"><p>Particularly helpful when we hav a large number of correlated predictors</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/Random_Forest_Bagging_Illustration.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
</section>
<section id="random-forests-in-r" class="slide level2">
<h2>Random forests in R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb20-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Random Forest model</span></span>
<span id="cb20-4"><a href="" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(species <span class="sc">~</span> ., <span class="at">data =</span> penguins, <span class="at">ntree =</span> <span class="dv">500</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb20-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rf_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = species ~ ., data = penguins, ntree = 500,      importance = TRUE) 
               Type of random forest: classification
                     Number of trees: 500
No. of variables tried at each split: 2

        OOB estimate of  error rate: 0.9%
Confusion matrix:
          Adelie Chinstrap Gentoo class.error
Adelie       145         1      0 0.006849315
Chinstrap      2        66      0 0.029411765
Gentoo         0         0    119 0.000000000</code></pre>
</div>
</div>
<ul>
<li class="fragment">One advantage of random forest is that they provide automatically an estimate of predictive performance.</li>
<li class="fragment">On average each boostrapped dataset include about 2/3 of training data, and we can assess how well the model predict the remaining 1/3 of data (Out-of-Bag, or OOB accuracy).</li>
</ul>
</section>
<section id="oob-confusion-matrix" class="slide level2">
<h2>OOB confusion matrix</h2>
<p>We can use a confusion matrix to assess the out-of-bag predictive accuracy</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">as.data.frame</span>(conf_mat<span class="sc">$</span>table), <span class="fu">aes</span>(Prediction, Reference, <span class="at">fill =</span> Freq)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb22-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Freq), <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Confusion Matrix"</span>,</span>
<span id="cb22-6"><a href="" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predicted Class"</span>,</span>
<span id="cb22-7"><a href="" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Actual Class"</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb22-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="supervised_files/figure-revealjs/unnamed-chunk-23-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boosting" class="slide level2">
<h2>Boosting</h2>
<ul>
<li class="fragment"><p>Boosting is also an ensemble method, in the sense that combine many models to produce a result that is more accurate and robust.</p></li>
<li class="fragment"><p>However, rather than combining many decision trees that were estimated independently, boosting work by sequentially improving a single model, focusing in particular in areas where it does not perform well.</p></li>
<li class="fragment"><p>A state-of-the-art improvement of boosting is gradient boosting, and is implemented in the R package <a href="https://xgboost.readthedocs.io/en/stable/#"><code>xgboost</code></a></p></li>
</ul>
<div class="quarto-auto-generated-content">
<p><img src="img/logo-small-london-cmyk.jpg" class="slide-logo"></p>
<div class="footer footer-default">
<p>PS3192 25-26</p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="supervised_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="supervised_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="supervised_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="supervised_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="supervised_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="supervised_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="supervised_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="supervised_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="supervised_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="supervised_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>