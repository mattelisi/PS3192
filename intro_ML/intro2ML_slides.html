<!DOCTYPE html>
<html lang="en"><head>
<script src="intro2ML_slides_files/libs/clipboard/clipboard.min.js"></script>
<script src="intro2ML_slides_files/libs/quarto-html/tabby.min.js"></script>
<script src="intro2ML_slides_files/libs/quarto-html/popper.min.js"></script>
<script src="intro2ML_slides_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="intro2ML_slides_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="intro2ML_slides_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="intro2ML_slides_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="intro2ML_slides_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Matteo Lisi">
  <title>PS3192: Data science for psychology</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="intro2ML_slides_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="intro2ML_slides_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="intro2ML_slides_files/libs/revealjs/dist/theme/quarto.css">
  <link href="intro2ML_slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="intro2ML_slides_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="intro2ML_slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="intro2ML_slides_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">PS3192: Data science for psychology</h1>
  <p class="subtitle"><br></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Matteo Lisi 
</div>
</div>
</div>

</section>
<section>
<section id="introduction-to-machine-learning" class="title-slide slide level1 inverse center" data-background-color="#EB641E">
<h1>Introduction to Machine Learning</h1>

</section>
<section id="section" class="slide level2" data-transition="slide-in slide-out">
<h2></h2>
<h4 id="data-science">“Data science”</h4>
<div>
<ul>
<li>Data wrangling (data cleaning &amp; preparation)</li>
<li>Data visualization</li>
<li>Statistics &amp; probability</li>
<li><strong>Machine learning &amp; predictive modelling</strong></li>
<li>Causal inference</li>
<li>Big data &amp; data engineering</li>
<li>Applied context (actionable insights)</li>
<li>Communication</li>
</ul>
</div>
<!-- ## Learning Outcomes for today -->
<!-- -   Grasp **fundamental machine learning** concepts -->
<!-- -   Recognize typical pitfalls -->
<!-- -   Build and evaluate models in R -->
</section>
<section id="machine-learning" class="slide level2">
<h2>Machine learning</h2>
<div class="fragment fade-up">
<blockquote>
<p><em>“as a set of methods that can automatically detect patterns in data, and then use the uncovered patterns to predict future data, or to perform other kinds of decision making under uncertainty”</em> (Murphy, 2012)</p>
</blockquote>
</div>
<p>&nbsp;</p>
<ul>
<li class="fragment">Machine learning (ML) is grounded in the same principles as statistical science.</li>
<li class="fragment">ML differs from statistics in that it has a “technological” rather that scientific focus: the goal in ML is to solve a problem, e.g.&nbsp;predict which product a customer might buy, rather than understanding the world.</li>
<li class="fragment">Close to artificial intelligence (AI) which is even more focused on creating machines that can carry out tasks that would normally require human involvement.</li>
</ul>
</section>
<section id="types-of-machine-learning" class="slide level2">
<h2>Types of machine learning</h2>
<ul>
<li class="fragment"><strong>Supervised learning</strong> predict the next value based on a set of examples (regression, classification).</li>
<li class="fragment"><strong>Unsupervised learning</strong> more descriptive and data driven (clustering).</li>
<li class="fragment"><strong>Reinforcement learning</strong> learn how to act from reward and punishment signals.</li>
</ul>
</section>
<section id="supervised-vs.-unsupervised-learning" class="slide level2">
<h2>Supervised vs.&nbsp;Unsupervised Learning</h2>
<p>&nbsp;</p>
<div class="fragment">
<p><strong>Supervised Learning</strong><br>
- We have a <em>training</em> dataset containing some with input features <span class="math inline">\(X\)</span> and target labels/outcomes <span class="math inline">\(y\)</span><br>
- The algorithm learns a function <span class="math inline">\(f(X)\)</span> that predicts <span class="math inline">\(y\)</span> accurately<br>
- Learning is achieved by minimising a <em>cost</em> or <em>loss</em> function (i.e.&nbsp;an error metric that tells us how bad the predictions are compared to the observed <span class="math inline">\(y\)</span>)<br>
- Examples: <strong>Regression</strong> (continuous outcomes), <strong>Classification</strong> (categorical outcomes)</p>
</div>
<p>&nbsp;</p>
<div class="fragment">
<p><strong>Unsupervised Learning</strong><br>
- We only have input features <span class="math inline">\(X\)</span>, with no labeled outcome<br>
- The algorithm finds structure in the data (e.g., clusters, latent factors)<br>
- Much less well-defined problem since we don’t know usually know in advance what to look for.<br>
- Examples: <strong>Clustering</strong> (e.g., gaussian mixture models), <strong>Dimensionality Reduction</strong> (PCA)</p>
</div>
</section>
<section id="linear-regression-as-a-supervised-ml-algorithm" class="slide level2">
<h2>Linear regression as a supervised ML algorithm</h2>
<div class="fragment">
<p>Model: <span class="math display">\[\hat y = \beta_0 + \beta_1 X_1 + \ldots + \beta_k X_k\]</span></p>
</div>
<div class="fragment">
<p>Residuals errors: <span class="math display">\[\epsilon_i = y_i - \hat y_i\]</span></p>
</div>
<div class="fragment">
<p>The <em>loss</em> function is the <strong>mean squared error</strong>: <span class="math display">\[\text{MSE} = \frac{1}{n}\sum_{i=1}^n \epsilon_i^2 \]</span></p>
</div>
</section>
<section id="logistic-regression-as-a-supervised-ml-algorithm" class="slide level2 scrollable">
<h2>Logistic regression as a supervised ML algorithm</h2>
<div class="fragment">
<p>Model (predicting a probability): <span class="math display">\[
\hat p_i = P(y_i = 1 \mid \mathbf X_i)
= \sigma(\beta_0 + \beta_1 X_{i1} + \ldots + \beta_k X_{ik})
\]</span></p>
<p>where <span class="math display">\[
\sigma(z) = \frac{1}{1 + e^{-z}}
\]</span></p>
</div>
<div class="fragment">
<p>Observed outcome: <span class="math display">\[
y_i \in \{0,1\}
\]</span></p>
<p>We compare the predicted probability <span class="math inline">\(\hat p_i\)</span> to the true class <span class="math inline">\(y_i\)</span>.</p>
</div>
<p>&nbsp;</p>
<div class="fragment">
<p>Loss function (<strong>cross-entropy / log loss</strong>): <span class="math display">\[
\mathcal L_i
= - \Big[ y_i \log(\hat p_i)
+ (1 - y_i)\log(1 - \hat p_i) \Big]
\]</span></p>
</div>
<div class="fragment">
<p>Average loss over the dataset: <span class="math display">\[
\text{Cross-entropy}
= \frac{1}{n}\sum_{i=1}^n \mathcal L_i
\]</span></p>
<p>The model is trained by choosing coefficients <span class="math inline">\(\beta\)</span> that minimise this loss.</p>
</div>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
<h4 id="cross-entropy-log-loss">Cross-entropy / log loss</h4>
<p>&nbsp;</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="intro2ML_slides_files/figure-revealjs/unnamed-chunk-2-1.png" class="quarto-figure quarto-figure-center" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section>
<section>
<section id="machine-learning-concepts" class="title-slide slide level1 inverse center" data-background-color="#EB641E">
<h1>Machine-learning concepts</h1>

</section>
<section id="section-2" class="slide level2">
<h2></h2>
<h3 id="parametric-vs-non-parametric-models">Parametric vs non-parametric models</h3>
<ul>
<li class="fragment"><p><strong>Parametric</strong> models are those which can describe/predict the data with a fixed number of parameters.</p></li>
<li class="fragment"><p><strong>Non-parametric</strong> models tend to now have a fixed number of parameters, and tend to make milder assumptions</p></li>
<li class="fragment"><p><em>There isn’t a precise and universally accepted definition of the term ‘nonparametric’.</em></p></li>
</ul>
</section>
<section id="section-3" class="slide level2">
<h2></h2>
<h4 id="non-parametric-supervised-learning-decision-trees">Non-parametric supervised learning: decision trees</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="intro2ML_slides_files/figure-revealjs/unnamed-chunk-3-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-4" class="slide level2">
<h2></h2>
<!-- ### Curse of dimensionality -->
<!--   -->
<!-- ::: {.fragment fragment-index="1"} -->
<!-- ML learning problems tend to be high-dimensional (e.g. datasets can easily have thousands or more feature $X$ that we can use for learning and prediction). -->
<!-- ::: -->
<!-- ::::::: columns -->
<!-- :::: {.column width="50%"} -->
<!-- ::: {.fragment fragment-index="2"} -->
<!--   -->
<!-- The amount of data that we need to learn effectively grows exponentially with the number of features -->
<!-- ::: -->
<!-- :::: -->
<!-- :::: {.column width="50%"} -->
<!-- ::: {.fragment fragment-index="2"} -->
<!-- ```{r} -->
<!-- #| fig-height: 3 -->
<!-- #| fig-width: 3  # Half the slider width when default slide width is 4 -->
<!-- #| fig-align: center -->
<!-- #| echo: FALSE -->
<!-- library(tidyverse) -->
<!-- x <- seq(10, 20, length.out=100) -->
<!-- y <- exp(x) -->
<!-- data.frame(x,y) %>% -->
<!--   ggplot(aes(x=x, y=y))+ -->
<!--   geom_line(lwd=2,col="red")+theme_void()+ -->
<!--   theme(axis.title.x = element_text(), -->
<!--         axis.title.y = element_text(angle=90))+ -->
<!--   labs(x="n. features",y="amount of data") -->
<!-- ``` -->
<!-- ::: -->
<!-- :::: -->
<!-- ::::::: -->
</section>
<section id="overfitting" class="slide level2">
<h2>Overfitting</h2>
<ul>
<li class="fragment"><p>Main goal of supervised ML is to make predictions on novel inputs not seen before (<strong>generalization</strong>)</p></li>
<li class="fragment"><p>When we fit highly complex/flexible model we need to be careful to not <strong>overfit</strong> the data, as this would lead to worse performance on unseen (new) data</p></li>
</ul>
</section>
<section id="overfitting-example" class="slide level2">
<h2>Overfitting example</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># assume a "true" underlying function</span></span>
<span id="cb1-2"><a href="" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb1-3"><a href="" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span><span class="fl">0.2</span><span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb1-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate some noisy observations</span></span>
<span id="cb1-6"><a href="" aria-hidden="true" tabindex="-1"></a>x_obs <span class="ot">&lt;-</span> x[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, <span class="dv">10</span>)]</span>
<span id="cb1-7"><a href="" aria-hidden="true" tabindex="-1"></a>y_obs <span class="ot">&lt;-</span> x_obs <span class="sc">+</span> x_obs<span class="sc">^</span><span class="dv">2</span>  <span class="sc">-</span><span class="fl">0.2</span><span class="sc">*</span>x_obs<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">50</span>)</span>
<span id="cb1-8"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># store in a dataframe</span></span>
<span id="cb1-10"><a href="" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>y_obs,</span>
<span id="cb1-11"><a href="" aria-hidden="true" tabindex="-1"></a>                <span class="at">x=</span>x_obs)</span>
<span id="cb1-12"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb1-14"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">200</span>, <span class="dv">300</span>))</span>
<span id="cb1-15"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x_obs, y_obs, <span class="at">pch=</span><span class="dv">19</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="intro2ML_slides_files/figure-revealjs/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center" width="384"></p>
</figure>
</div>
</div>
</div>
</div></div>
<div class="fragment">
<p>Known “true” model: <span class="math display">\[y = x + x^2 -0.2x^3\]</span></p>
</div>
</section>
<section id="overfitting-example-1" class="slide level2">
<h2>Overfitting example</h2>
<p>We can fit polynomial functions of increasing order using <code>lm()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-2"><a href="" aria-hidden="true" tabindex="-1"></a>m[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span><span class="dv">1</span>, d)</span>
<span id="cb2-3"><a href="" aria-hidden="true" tabindex="-1"></a>m[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x, d)</span>
<span id="cb2-4"><a href="" aria-hidden="true" tabindex="-1"></a>m[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x <span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), d)</span>
<span id="cb2-5"><a href="" aria-hidden="true" tabindex="-1"></a>m[[<span class="dv">4</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x <span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>), d)</span>
<span id="cb2-6"><a href="" aria-hidden="true" tabindex="-1"></a>m[[<span class="dv">5</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x <span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>), d)</span>
<span id="cb2-7"><a href="" aria-hidden="true" tabindex="-1"></a>m[[<span class="dv">6</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x <span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>) <span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">5</span>), d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="overfitting-example-2" class="slide level2">
<h2>Overfitting example</h2>
<p>We can fit polynomial functions of increasing order using <code>lm()</code></p>
<p>&nbsp;</p>
<p>We can use a <code>for</code> loop to programmatically fit models of increasing complexity</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">list</span>() <span class="co"># an empty list</span></span>
<span id="cb3-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># intercept-only model in the 1st slot</span></span>
<span id="cb3-4"><a href="" aria-hidden="true" tabindex="-1"></a>m[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span><span class="dv">1</span>, d)</span>
<span id="cb3-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models of increasing complexity</span></span>
<span id="cb3-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb3-8"><a href="" aria-hidden="true" tabindex="-1"></a>  formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"y ~"</span>, <span class="fu">paste0</span>(<span class="st">"I(x^"</span>, <span class="dv">1</span><span class="sc">:</span>p, <span class="st">")"</span>, <span class="at">collapse=</span><span class="st">"+"</span>)))</span>
<span id="cb3-9"><a href="" aria-hidden="true" tabindex="-1"></a>  m[[p <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data =</span> d)</span>
<span id="cb3-10"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="overfitting-example-3" class="slide level2">
<h2>Overfitting example</h2>
<p>For each model, let’s compute the error in the training set</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># error on training set</span></span>
<span id="cb4-2"><a href="" aria-hidden="true" tabindex="-1"></a>training_error <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(m))</span>
<span id="cb4-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(m)){</span>
<span id="cb4-5"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract predicted values</span></span>
<span id="cb4-7"><a href="" aria-hidden="true" tabindex="-1"></a>  pred_y <span class="ot">&lt;-</span> <span class="fu">predict</span>(m[[i]]) </span>
<span id="cb4-8"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mean squared error</span></span>
<span id="cb4-10"><a href="" aria-hidden="true" tabindex="-1"></a>  training_error[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((d<span class="sc">$</span>y <span class="sc">-</span>  pred_y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-11"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="overfitting-example-4" class="slide level2">
<h2>Overfitting example</h2>
<p>We know the “true” generative model and we can use to generate new data unseen by our models</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># generate unseen data</span></span>
<span id="cb5-2"><a href="" aria-hidden="true" tabindex="-1"></a>x_new <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>, <span class="at">min=</span><span class="sc">-</span><span class="dv">10</span>, <span class="at">max=</span><span class="dv">10</span>)</span>
<span id="cb5-3"><a href="" aria-hidden="true" tabindex="-1"></a>y_new <span class="ot">&lt;-</span> x_new <span class="sc">+</span> x_new<span class="sc">^</span><span class="dv">2</span>  <span class="sc">-</span><span class="fl">0.2</span><span class="sc">*</span>x_new<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">50</span>)</span>
<span id="cb5-4"><a href="" aria-hidden="true" tabindex="-1"></a>d_new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_new, <span class="at">y=</span>y_new)</span>
<span id="cb5-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="" aria-hidden="true" tabindex="-1"></a>test_error <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(m))</span>
<span id="cb5-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(m)){</span>
<span id="cb5-8"><a href="" aria-hidden="true" tabindex="-1"></a>  pred_y <span class="ot">&lt;-</span> <span class="fu">predict</span>(m[[i]], <span class="at">newdata=</span>d_new)</span>
<span id="cb5-9"><a href="" aria-hidden="true" tabindex="-1"></a>  test_error[i] <span class="ot">&lt;-</span>  <span class="fu">mean</span>((d_new<span class="sc">$</span>y <span class="sc">-</span>  pred_y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-10"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="overfitting-example-5" class="slide level2">
<h2>Overfitting example</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(m), training_error,</span>
<span id="cb6-2"><a href="" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"n. parameters"</span>, <span class="at">ylab=</span><span class="st">"MSE"</span>,</span>
<span id="cb6-3"><a href="" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">9000</span>), <span class="at">type=</span><span class="st">"o"</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb6-4"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(m), test_error, <span class="at">type=</span><span class="st">"o"</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="intro2ML_slides_files/figure-revealjs/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="overfitting-example-6" class="slide level2">
<h2>Overfitting example</h2>
<p>The higher order polynomials are clearly too complex and overfit the data</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="intro2ML_slides_files/figure-revealjs/unnamed-chunk-11-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="approached-to-mitigage-overfitting-cross-validation" class="slide level2">
<h2>Approached to mitigage overfitting: cross-Validation</h2>
<ul>
<li class="fragment">Split data into <span class="math inline">\(k\)</span> folds (subsets)<br>
</li>
<li class="fragment">Train on <span class="math inline">\(k - 1\)</span> folds, test on the remaining, hold-out fold<br>
</li>
<li class="fragment">Repeat for each fold; average performance across folds for a robust metric.</li>
<li class="fragment">When we leave out only 1 observation is known as leave-one-out (LOO) cross-validation</li>
</ul>
<p>&nbsp;</p>
<div class="fragment">
<p>The key idea is that we put aside some data when training the model, and then use it for evaluate its performance</p>
</div>
</section>
<section id="section-5" class="slide level2">
<h2></h2>
<p><strong>Example code 1</strong>: evaluating a linear model on a hold-out set</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose 'mydata' has columns: y, X1, X2</span></span>
<span id="cb7-2"><a href="" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"mydata.csv"</span>)</span>
<span id="cb7-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb7-5"><a href="" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(mydata)), <span class="at">size =</span> <span class="fl">0.7</span><span class="sc">*</span><span class="fu">nrow</span>(mydata))</span>
<span id="cb7-6"><a href="" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> mydata[train_index, ]</span>
<span id="cb7-7"><a href="" aria-hidden="true" tabindex="-1"></a>test_data  <span class="ot">&lt;-</span> mydata[<span class="sc">-</span>train_index, ]</span>
<span id="cb7-8"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model</span></span>
<span id="cb7-10"><a href="" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> train_data)</span>
<span id="cb7-11"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict on test data</span></span>
<span id="cb7-13"><a href="" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> test_data)</span>
<span id="cb7-14"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Mean Squared Error</span></span>
<span id="cb7-16"><a href="" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((test_data<span class="sc">$</span>y <span class="sc">-</span> preds)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-6" class="slide level2">
<h2></h2>
<p><strong>Example code 2</strong>: LOO cross-validation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose 'mydata' has columns: y, X1, X2</span></span>
<span id="cb8-2"><a href="" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"mydata.csv"</span>)</span>
<span id="cb8-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mydata)  <span class="co"># Total number of observations</span></span>
<span id="cb8-5"><a href="" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)  <span class="co"># Placeholder for predictions</span></span>
<span id="cb8-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Leave-One-Out Cross-Validation</span></span>
<span id="cb8-8"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb8-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define training and test sets</span></span>
<span id="cb8-11"><a href="" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> mydata[<span class="sc">-</span>i, ]  <span class="co"># All except the i-th observation</span></span>
<span id="cb8-12"><a href="" aria-hidden="true" tabindex="-1"></a>  test_data  <span class="ot">&lt;-</span> mydata[i,  ]  <span class="co"># The i-th observation</span></span>
<span id="cb8-13"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-14"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit the model</span></span>
<span id="cb8-15"><a href="" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X1 <span class="sc">+</span> X2, <span class="at">data =</span> train_data)</span>
<span id="cb8-16"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-17"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Predict for the left-out observation</span></span>
<span id="cb8-18"><a href="" aria-hidden="true" tabindex="-1"></a>  preds[i] <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> test_data)</span>
<span id="cb8-19"><a href="" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-20"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute overall Mean Squared Error</span></span>
<span id="cb8-22"><a href="" aria-hidden="true" tabindex="-1"></a>mse_loo <span class="ot">&lt;-</span> <span class="fu">mean</span>((mydata<span class="sc">$</span>y <span class="sc">-</span> preds)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="last-week-california-housing-dataset" class="slide level2">
<h2>Last week: California Housing Dataset</h2>
<p>(See week 1 worksheet)</p>
<div style="font-size: 60%;">
<table class="caption-top">
<colgroup>
<col style="width: 48%">
<col style="width: 51%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>medv</strong></td>
<td><strong>Median value of owner-occupied homes (in $1000s)</strong></td>
</tr>
<tr class="even">
<td>crim</td>
<td>Per capita crime rate by town</td>
</tr>
<tr class="odd">
<td>zn</td>
<td>Proportion of residential land zoned for large lots</td>
</tr>
<tr class="even">
<td>indus</td>
<td>Proportion of non-retail business acres per town</td>
</tr>
<tr class="odd">
<td>chas</td>
<td>Charles River dummy variable (1 if tract bounds river, 0 otherwise)</td>
</tr>
<tr class="even">
<td>nox</td>
<td>Nitrogen oxide concentration (parts per 10 million)</td>
</tr>
<tr class="odd">
<td>rm</td>
<td>Average number of rooms per dwelling</td>
</tr>
<tr class="even">
<td>age</td>
<td>Proportion of owner-occupied units built before 1940</td>
</tr>
<tr class="odd">
<td>dis</td>
<td>Weighted distance to employment centers</td>
</tr>
<tr class="even">
<td>rad</td>
<td>Index of accessibility to highways</td>
</tr>
<tr class="odd">
<td>tax</td>
<td>Property tax rate per $10,000</td>
</tr>
<tr class="even">
<td>ptratio</td>
<td>Pupil-teacher ratio by town</td>
</tr>
<tr class="odd">
<td>lstat</td>
<td>% lower status of the population</td>
</tr>
<tr class="even">
<td>lon</td>
<td>longitude</td>
</tr>
<tr class="odd">
<td>lat</td>
<td>latitude</td>
</tr>
</tbody>
</table>
</div>
</section></section>
<section>
<section id="last-week-california-housing-dataset-1" class="title-slide slide level1 inverse center" data-background-color="#EB641E">
<h1>Last week: California Housing Dataset</h1>

</section>
<section id="california-housing-exercise" class="slide level2">
<h2>California Housing exercise</h2>
<p>If you have attempted it (it was optional), you may have realised that it is <em>hard</em>:</p>
<ul>
<li class="fragment">a lot of degrees of freedom and possible modelling choices</li>
<li class="fragment">a lot of uncertainty on which model will perform better on new data (the test set)</li>
</ul>
<p>&nbsp;</p>
<div class="fragment">
<ul>
<li class="fragment">On possible approach is to simply test models with different subset of predictors</li>
<li class="fragment">(also a good example of how we can use control flow statements to do automatise data-science tasks)</li>
</ul>
</div>
</section>
<section id="section-7" class="slide level2">
<h2></h2>
<p>Load the Training Data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="" aria-hidden="true" tabindex="-1"></a>d_train <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"california_housing_train.csv"</span>)</span>
<span id="cb9-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(d_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   100 obs. of  15 variables:
 $ lon    : num  -71.1 -71.1 -71 -71.1 -71.1 ...
 $ lat    : num  42.2 42.2 42.2 42.2 42.2 ...
 $ medv   : num  22.5 46.7 11.3 25 33.2 36 17.5 22.5 21.8 36.1 ...
 $ crim   : num  0.252 0.298 9.187 0.198 0.105 ...
 $ zn     : num  0 0 0 0 40 20 0 0 0 33 ...
 $ indus  : num  10.59 6.2 18.1 10.59 6.41 ...
 $ chas   : int  0 0 0 0 1 0 0 0 0 0 ...
 $ nox    : num  0.489 0.504 0.7 0.489 0.447 0.647 0.442 0.449 0.532 0.472 ...
 $ rm     : num  5.78 7.69 5.54 6.18 7.27 ...
 $ age    : num  72.7 17 100 42.4 49 100 48.5 45.1 40.3 41.1 ...
 $ dis    : num  4.35 3.38 1.58 3.95 4.79 ...
 $ rad    : int  4 8 24 4 4 5 3 3 24 7 ...
 $ tax    : int  277 307 666 277 254 264 352 247 666 222 ...
 $ ptratio: num  18.6 17.4 20.2 18.6 17.6 13 18.8 18.5 20.2 18.4 ...
 $ lstat  : num  18.06 3.92 23.6 9.47 6.05 ...</code></pre>
</div>
</div>
</section>
<section id="section-8" class="slide level2">
<h2></h2>
<p>Generate all model formulas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="" aria-hidden="true" tabindex="-1"></a>var_list <span class="ot">&lt;-</span> <span class="fu">colnames</span>(d_train[,<span class="sc">-</span><span class="fu">which</span>(<span class="fu">colnames</span>(d_train)<span class="sc">==</span><span class="st">"medv"</span>)])</span>
<span id="cb11-2"><a href="" aria-hidden="true" tabindex="-1"></a>dependent_var <span class="ot">&lt;-</span> <span class="st">"medv"</span></span>
<span id="cb11-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># empty list to hold all formulae</span></span>
<span id="cb11-5"><a href="" aria-hidden="true" tabindex="-1"></a>all_formulas <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># generate combinations of variables</span></span>
<span id="cb11-8"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(var_list)){</span>
<span id="cb11-9"><a href="" aria-hidden="true" tabindex="-1"></a>  combinations <span class="ot">&lt;-</span> <span class="fu">combn</span>(var_list, i)</span>
<span id="cb11-10"><a href="" aria-hidden="true" tabindex="-1"></a>  num_combinations <span class="ot">&lt;-</span> <span class="fu">ncol</span>(combinations)</span>
<span id="cb11-11"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-12"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># loop over combinations and create formulas</span></span>
<span id="cb11-13"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_combinations){</span>
<span id="cb11-14"><a href="" aria-hidden="true" tabindex="-1"></a>    formula <span class="ot">&lt;-</span> <span class="fu">paste</span>(dependent_var, <span class="st">"~"</span>, </span>
<span id="cb11-15"><a href="" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">paste</span>(combinations[,j], <span class="at">collapse =</span> <span class="st">" + "</span>))</span>
<span id="cb11-16"><a href="" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-17"><a href="" aria-hidden="true" tabindex="-1"></a>    all_formulas <span class="ot">&lt;-</span> <span class="fu">c</span>(all_formulas, formula)</span>
<span id="cb11-18"><a href="" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-19"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-9" class="slide level2">
<h2></h2>
<p>How many models?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(all_formulas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16383</code></pre>
</div>
</div>
<div class="fragment">
<p>Example formulas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="" aria-hidden="true" tabindex="-1"></a>all_formulas[<span class="fu">sample</span>(<span class="fu">length</span>(all_formulas), <span class="dv">5</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "medv ~ lon + crim + zn + indus + nox + rm + age + dis + rad + tax + lstat"

[[2]]
[1] "medv ~ lat + crim + zn + chas + rad + tax + ptratio + lstat"

[[3]]
[1] "medv ~ lon + lat + indus + chas + nox + rm + ptratio + lstat"

[[4]]
[1] "medv ~ crim + indus + nox + rm + rad + tax + lstat"

[[5]]
[1] "medv ~ zn + chas + rm + dis + ptratio + lstat"</code></pre>
</div>
</div>
</div>
</section>
<section id="section-10" class="slide level2 scrollable">
<h2></h2>
<p>Custom Function: LOO cross-validation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="" aria-hidden="true" tabindex="-1"></a>loocrossval <span class="ot">&lt;-</span> <span class="cf">function</span>(mydata, formula){</span>
<span id="cb16-2"><a href="" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mydata)  <span class="co"># Total number of observations</span></span>
<span id="cb16-3"><a href="" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)  <span class="co"># Placeholder for predictions</span></span>
<span id="cb16-4"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the outcome name from the formula</span></span>
<span id="cb16-6"><a href="" aria-hidden="true" tabindex="-1"></a>  outcome_var <span class="ot">&lt;-</span> <span class="fu">all.vars</span>(<span class="fu">as.formula</span>(formula))[<span class="dv">1</span>]</span>
<span id="cb16-7"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Leave-One-Out Cross-Validation</span></span>
<span id="cb16-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb16-10"><a href="" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-11"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define training and test sets</span></span>
<span id="cb16-12"><a href="" aria-hidden="true" tabindex="-1"></a>    train_data <span class="ot">&lt;-</span> mydata[<span class="sc">-</span>i, ]  <span class="co"># All except the i-th observation</span></span>
<span id="cb16-13"><a href="" aria-hidden="true" tabindex="-1"></a>    test_data  <span class="ot">&lt;-</span> mydata[i,  ]  <span class="co"># The i-th observation</span></span>
<span id="cb16-14"><a href="" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-15"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit the model</span></span>
<span id="cb16-16"><a href="" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data =</span> train_data)</span>
<span id="cb16-17"><a href="" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-18"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Predict for the left-out observation</span></span>
<span id="cb16-19"><a href="" aria-hidden="true" tabindex="-1"></a>    preds[i] <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> test_data)</span>
<span id="cb16-20"><a href="" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-21"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-22"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute Mean Squared Error</span></span>
<span id="cb16-23"><a href="" aria-hidden="true" tabindex="-1"></a>  mse_loo <span class="ot">&lt;-</span> <span class="fu">mean</span>((mydata[[outcome_var]] <span class="sc">-</span> preds)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb16-24"><a href="" aria-hidden="true" tabindex="-1"></a>  rsquared_loo <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (mse_loo<span class="sc">/</span><span class="fu">mean</span>((mydata[[outcome_var]] <span class="sc">-</span> <span class="fu">mean</span>(mydata[[outcome_var]]))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb16-25"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-26"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return results as named vector</span></span>
<span id="cb16-27"><a href="" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">c</span>(mse_loo, rsquared_loo)</span>
<span id="cb16-28"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(res) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"MSE"</span>,<span class="st">"r-squared"</span>)</span>
<span id="cb16-29"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-30"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># result</span></span>
<span id="cb16-31"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb16-32"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-11" class="slide level2">
<h2></h2>
<p>Test All Models</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">list</span>() <span class="co"># an empty list</span></span>
<span id="cb17-2"><a href="" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb17-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># warning: this step may take some time to complete!</span></span>
<span id="cb17-5"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(all_formulas)) {</span>
<span id="cb17-6"><a href="" aria-hidden="true" tabindex="-1"></a>  m[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(all_formulas[[i]], <span class="at">data =</span> d_train)</span>
<span id="cb17-7"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-8"><a href="" aria-hidden="true" tabindex="-1"></a>  crossval_res <span class="ot">&lt;-</span> <span class="fu">loocrossval</span>(d_train, all_formulas[[i]])</span>
<span id="cb17-9"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print some output to show progress</span></span>
<span id="cb17-11"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"model "</span>,i, <span class="st">"out of "</span>, <span class="fu">length</span>(all_formulas), <span class="st">"completed:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb17-12"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(crossval_res)</span>
<span id="cb17-13"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb17-14"><a href="" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-15"><a href="" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, </span>
<span id="cb17-16"><a href="" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">data.frame</span>(<span class="at">MSE=</span> crossval_res[<span class="st">"MSE"</span>],</span>
<span id="cb17-17"><a href="" aria-hidden="true" tabindex="-1"></a>                            <span class="at">r_squared =</span> crossval_res[<span class="st">"r-squared"</span>],</span>
<span id="cb17-18"><a href="" aria-hidden="true" tabindex="-1"></a>                            <span class="at">formula =</span> all_formulas[[i]]))</span>
<span id="cb17-19"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-12" class="slide level2">
<h2></h2>
<p>Find the <em>best</em> model (by LOO MSE)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="" aria-hidden="true" tabindex="-1"></a>best_formula <span class="ot">&lt;-</span> results<span class="sc">$</span>formula[results<span class="sc">$</span>MSE<span class="sc">==</span><span class="fu">min</span>(results<span class="sc">$</span>MSE)]</span>
<span id="cb18-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(best_formula)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "medv ~ lon + lat + crim + rm + age + dis + tax + lstat"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># LOO MSE error of best model</span></span>
<span id="cb20-2"><a href="" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>MSE[results<span class="sc">$</span>MSE<span class="sc">==</span><span class="fu">min</span>(results<span class="sc">$</span>MSE)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.27313</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># LOO r-squared of best model</span></span>
<span id="cb22-2"><a href="" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>r_squared[results<span class="sc">$</span>MSE<span class="sc">==</span><span class="fu">min</span>(results<span class="sc">$</span>MSE)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8486196</code></pre>
</div>
</div>
</section>
<section id="section-13" class="slide level2">
<h2></h2>
<p>Evaluate on the True Test Set</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># load test set</span></span>
<span id="cb24-2"><a href="" aria-hidden="true" tabindex="-1"></a>d_test <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"california_housing_test.csv"</span>)</span>
<span id="cb24-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model parameters using training set data</span></span>
<span id="cb24-5"><a href="" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(best_formula, <span class="at">data =</span> d_train)</span>
<span id="cb24-6"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict values of test data</span></span>
<span id="cb24-8"><a href="" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_model, <span class="at">newdata =</span> d_test)</span>
<span id="cb24-9"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate performance in test set</span></span>
<span id="cb24-11"><a href="" aria-hidden="true" tabindex="-1"></a>test_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((d_test<span class="sc">$</span>medv <span class="sc">-</span> preds)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb24-12"><a href="" aria-hidden="true" tabindex="-1"></a>test_rsquared <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (test_mse<span class="sc">/</span><span class="fu">mean</span>((d_test<span class="sc">$</span>medv<span class="sc">-</span> <span class="fu">mean</span>(d_test<span class="sc">$</span>medv))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb24-13"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="" aria-hidden="true" tabindex="-1"></a>test_mse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 38.94542</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="" aria-hidden="true" tabindex="-1"></a>test_rsquared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5304341</code></pre>
</div>
</div>
</section>
<section id="section-14" class="slide level2">
<h2></h2>
<p>Train vs Test Error (All Models)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="intro2ML_slides_files/figure-revealjs/unnamed-chunk-24-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-15" class="slide level2">
<h2></h2>
<p>Train vs Test Error (All Models)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="intro2ML_slides_files/figure-revealjs/unnamed-chunk-25-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="fragment">
<pre><code>lm(medv ~ rm + I(rm^2) + lstat)</code></pre>
</div>
</section>
<section id="section-16" class="slide level2">
<h2></h2>
<p>Histogram of test-set error (all models)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="intro2ML_slides_files/figure-revealjs/unnamed-chunk-26-1.png" class="quarto-figure quarto-figure-center" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="take-home" class="slide level2">
<h2>Take-Home</h2>
<ul>
<li class="fragment">Cross-validation is helpful, but can be optimistic if used for model selection.</li>
<li class="fragment">The true test set gives a more honest estimate of generalization.</li>
<li class="fragment">Even simple models can be competitive with a good feature choice.</li>
</ul>
</section>
<section id="approaches-to-mitigate-overfitting-regularisation" class="slide level2">
<h2>Approaches to mitigate overfitting: regularisation</h2>
<p>Cross-validation helps us measure how well a model generalizes.</p>
<p>&nbsp;</p>
<div class="fragment">
<p>Regularisation is a different idea: it changes how the model is fitted in the first place, making overfitting less likely.</p>
</div>
</section>
<section id="the-core-problem" class="slide level2">
<h2>The core problem</h2>
<p>When a model has many predictors (or very flexible predictors):</p>
<ul>
<li class="fragment">It can fit the training data extremely well</li>
<li class="fragment">But some of that fit may be:
<ul>
<li class="fragment">Noise</li>
<li class="fragment">Accidental patterns</li>
<li class="fragment">Idiosyncrasies of this particular sample</li>
</ul></li>
</ul>
<div class="fragment">
<p>This leads to <strong>overfitting</strong>: good performance on training data, poor performance on new data.</p>
</div>
</section>
<section id="intuition-keeping-models-simple-but-not-too-simple" class="slide level2">
<h2>Intuition: keeping models simple (but not too simple)</h2>
<p>Regularisation encodes a preference for <em>simpler</em> models.</p>
<p>Roughly speaking:</p>
<ul>
<li class="fragment">Large regression coefficients mean:
<ul>
<li class="fragment">The model is relying very strongly on some predictors</li>
</ul></li>
<li class="fragment">Regularisation:
<ul>
<li class="fragment">Penalises large coefficients</li>
<li class="fragment">Induces a form of ‘feature selection’ during model fitting</li>
</ul></li>
</ul>
</section>
<section id="regularisation-as-a-trade-off" class="slide level2">
<h2>Regularisation as a trade-off</h2>
<p>Regularised models balance two competing goals:</p>
<ol type="1">
<li class="fragment">Fit the data well</li>
<li class="fragment">Keep the model simple</li>
</ol>
<div class="fragment">
<p>This trade-off can be written as:</p>
<p><span class="math display">\[\text{Loss} = \text{Residual error} + \text{Penalty}\]</span></p>
<ul>
<li class="fragment">The <strong>residual error</strong> rewards accuracy</li>
<li class="fragment">The <strong>penalty</strong> discourages complexity (computed as a function of the summed magnitude of the regression coefficients)</li>
</ul>
</div>
</section>
<section id="the-penalty-parameter" class="slide level2">
<h2>The penalty parameter</h2>
<p>Regularised regression introduces a tuning parameter, often called <span class="math inline">\(\lambda\)</span>:</p>
<ul>
<li class="fragment">Small <span class="math inline">\(\lambda\)</span>:
<ul>
<li class="fragment">Weak penalty<br>
</li>
<li class="fragment">Model behaves like ordinary regression</li>
</ul></li>
<li class="fragment">Large ():
<ul>
<li class="fragment">Strong penalty<br>
</li>
<li class="fragment">Coefficients are shrunk towards zero</li>
</ul></li>
</ul>
<div class="fragment">
<p>Choosing <span class="math inline">\(\lambda\)</span> is crucial — and is typically done using <strong>cross-validation</strong>.</p>
</div>
</section>
<section id="shrinkage" class="slide level2">
<h2>Shrinkage</h2>
<p>A key effect of regularisation is <strong>shrinkage</strong>:</p>
<ul>
<li class="fragment">Coefficients are pulled towards zero</li>
<li class="fragment">Large coefficients are reduced the most</li>
<li class="fragment">Small coefficients may become negligible</li>
</ul>
<div class="fragment">
<p>Shrinkage: - Reduces sensitivity to noise - Stabilises estimates when predictors are correlated - Often improves out-of-sample prediction</p>
</div>
</section>
<section id="two-common-types-of-regularisation" class="slide level2">
<h2>Two common types of regularisation</h2>
<p>The two most common forms of regularisation in linear models are:</p>
<ul>
<li class="fragment"><strong>Ridge regression</strong></li>
<li class="fragment"><strong>LASSO regression</strong></li>
</ul>
<div class="fragment">
<p>Both use the same basic idea (a penalty on coefficient size), but differ in how the penalty is applied.</p>
</div>
</section>
<section id="ridge-regression-l2-regularisation" class="slide level2">
<h2>Ridge regression (L2 regularisation)</h2>
<p>Ridge regression:</p>
<ul>
<li class="fragment">Penalises the <strong>sum of squared coefficients</strong></li>
<li class="fragment">Shrinks coefficients towards zero</li>
<li class="fragment">Typically <strong>does not set coefficients exactly to zero</strong></li>
</ul>
<div class="fragment">
<p>Consequences:</p>
<ul>
<li class="fragment">All predictors usually remain in the model</li>
<li class="fragment">Particularly useful when predictors are highly correlated</li>
<li class="fragment">Produces more stable, less variable estimates</li>
</ul>
</div>
</section>
<section id="lasso-regression-l1-regularisation" class="slide level2">
<h2>Lasso regression (L1 regularisation)</h2>
<p>Lasso regression:</p>
<ul>
<li class="fragment">Penalises the <strong>sum of absolute coefficients</strong></li>
<li class="fragment">Shrinks coefficients towards zero</li>
<li class="fragment">Can set some coefficients <strong>exactly to zero</strong></li>
</ul>
<div class="fragment">
<p>Consequences:</p>
<ul>
<li class="fragment">Performs <strong>automatic variable selection</strong></li>
<li class="fragment">Produces sparse models</li>
<li class="fragment">Easier to interpret when many predictors are irrelevant</li>
</ul>
</div>
<!-- ## Sparsity -->
<!-- A model is called **sparse** if: -->
<!-- - Many coefficients are exactly zero -->
<!-- - Only a subset of predictors are used -->
<!-- Lasso regression encourages sparsity. -->
<!-- Why this can be useful: -->
<!-- - Simpler models -->
<!-- - Easier interpretation -->
<!-- - Often better generalisation when many predictors are noisy -->
</section>
<section id="ridge-vs-lasso" class="slide level2">
<h2>Ridge vs lasso</h2>
<ul>
<li class="fragment">Ridge:
<ul>
<li class="fragment">Keeps all predictors</li>
<li class="fragment">Shrinks them smoothly</li>
<li class="fragment">Good when many predictors carry small amounts of information</li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li class="fragment">Lasso:
<ul>
<li class="fragment">Drops some predictors entirely</li>
<li class="fragment">Performs variable selection</li>
<li class="fragment">Good when only a few predictors matter</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<p>Neither is “always better” — it depends on the data and the goal.</p>
</div>
<!-- $$\text{Loss} = \frac{1}{n} -->
<!-- \sum_{i=1}^{n} -->
<!-- \left(y_i - \hat y_i \right)^2 -->
<!-- \;+\; -->
<!-- \lambda -->
<!-- \left[ -->
<!-- \alpha \sum |\boldsymbol{\beta}| -->
<!-- +(1-\alpha) \sum \boldsymbol{\beta}^2 -->
<!-- \right]$$ -->
<!-- $$\min_{\beta_0, \boldsymbol{\beta}} -->
<!-- \frac{1}{2n} -->
<!-- \sum_{i=1}^{n} -->
<!-- \left(y_i - \beta_0 - \mathbf{x}_i^\top \boldsymbol{\beta} \right)^2 -->
<!-- \;+\; -->
<!-- \lambda -->
<!-- \left[ -->
<!-- \alpha \sum_{j=1}^{p} |\beta_j| -->
<!-- + -->
<!-- \frac{1}{2}(1-\alpha) \sum_{j=1}^{p} \beta_j^2 -->
<!-- \right]$$ -->
<!-- ## Regularisation and cross-validation work together -->
<!-- Regularisation introduces a tuning parameter ($\lambda$). -->
<!-- Cross-validation helps us answer: -->
<!-- > “How strong should the regularisation be?” -->
<!-- Typical workflow: -->
<!-- 1. Choose a model type (ridge or lasso) -->
<!-- 2. Try many values of $\lambda$ -->
<!-- 3. Use cross-validation to estimate predictive performance -->
<!-- 4. Select the value of $\lambda$ that generalizes best -->
<!-- ## Big picture -->
<!-- - Cross-validation: -->
<!--   - Evaluates how well a model generalizes -->
<!-- - Regularisation: -->
<!--   - Builds generalisation into the model itself -->
<!-- Both are core tools in modern machine learning. -->
</section>
<section id="no-free-lunch-theorem-wolpert-1996" class="slide level2">
<h2>“No Free Lunch Theorem” (Wolpert, 1996)</h2>
<ul>
<li class="fragment"><p>No single model or approach is universally the best across all problems.</p></li>
<li class="fragment"><p>A method that performs well in one domain may fail in another.</p></li>
<li class="fragment"><p>Model selection depends on <strong>problem-specific assumptions</strong> and <strong>data characteristics</strong>.</p></li>
</ul>
</section></section>
<section>
<section id="common-pitfalls" class="title-slide slide level1 inverse center" data-background-color="#EB641E">
<h1>Common pitfalls</h1>

</section>
<section id="section-17" class="slide level2">
<h2></h2>
<p><strong>Dataset bias</strong> More data is not always better.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/survey_bias.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</section>
<section id="section-18" class="slide level2">
<h2></h2>
<p><strong>Leakage of information from test set to training set</strong> (“feature hacking”, “double-dipping”)</p>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/ML_suicide_1.png" class="quarto-figure quarto-figure-center" style="width:90.0%"></p>
</figure>
</div>
</div>
</section>
<section id="section-19" class="slide level2">
<h2></h2>
<p>Retraction</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/ML_suicide_2.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>
<blockquote>
<p><em>Using information from data in a validation set to determine the structure of a model leads to inflated estimates of performance. This can happen either by selecting the observations (for example, only including the subset of participants that maximize validation set performance) or features (for example, applying arbitrary transformations of variables based on validation set performance) based on information from what should be a protected part of the sample. Our re-analysis shows that the classification results reported by ref. 3 are probably inflated due to the presence of information leakage somewhere in the feature selection process.</em></p>
</blockquote>
</section>
<section id="ethics-of-ml" class="slide level2">
<h2>Ethics of ML</h2>
<ul>
<li class="fragment"><p><strong>Algorithmic Bias</strong>. ML models can reinforce or amplify existing biases in data, leading to unfair or discriminatory outcomes.</p></li>
<li class="fragment"><p><strong>Transparency &amp; interpretability</strong>. Black-box models (e.g., deep neural; networks) can be hard to interpret. Would you trust an AI to make life-changing decisions (hiring, loans, medical diagnoses) if it can’t explain why?</p></li>
<li class="fragment"><p><strong>Accountability</strong>. Who is responsible when ML systems make wrong decisions? (Companies? Developers? Users? Governments?). There is a need for clear regulations.</p></li>
</ul>
<div class="quarto-auto-generated-content">
<p><img src="img/logo-small-london-cmyk.jpg" class="slide-logo"></p>
<div class="footer footer-default">
<p>PS3192 25-26</p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="intro2ML_slides_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="intro2ML_slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="intro2ML_slides_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="intro2ML_slides_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="intro2ML_slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="intro2ML_slides_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="intro2ML_slides_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="intro2ML_slides_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="intro2ML_slides_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="intro2ML_slides_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>