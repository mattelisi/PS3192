<!DOCTYPE html>
<html lang="en"><head>
<script src="unsupervised_GMM_files/libs/clipboard/clipboard.min.js"></script>
<script src="unsupervised_GMM_files/libs/quarto-html/tabby.min.js"></script>
<script src="unsupervised_GMM_files/libs/quarto-html/popper.min.js"></script>
<script src="unsupervised_GMM_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="unsupervised_GMM_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="unsupervised_GMM_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="unsupervised_GMM_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="unsupervised_GMM_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Matteo Lisi">
  <title>PS3192: Unsupervised learning</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="unsupervised_GMM_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="unsupervised_GMM_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="unsupervised_GMM_files/libs/revealjs/dist/theme/quarto.css">
  <link href="unsupervised_GMM_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="unsupervised_GMM_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="unsupervised_GMM_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="unsupervised_GMM_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">PS3192: Unsupervised learning</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Matteo Lisi 
</div>
</div>
</div>

</section>
<section id="supervised-vs.-unsupervised-learning" class="slide level2">
<h2>Supervised vs.&nbsp;unsupervised learning</h2>
<p>&nbsp;</p>
<div>
<ul>
<li><p><strong>Supervised learning:</strong> training data contains a set of input features (predictors) and target labels/outcome.</p></li>
<li><p><strong>Unsupervised learning:</strong> learning patterns from <em>unlabeled data</em>.</p></li>
</ul>
</div>
</section>
<section id="supervised-vs.-unsupervised-learning-1" class="slide level2">
<h2>Supervised vs.&nbsp;unsupervised learning</h2>
<p>&nbsp;</p>
<div class="fragment">
<p><strong>Supervised Learning</strong><br>
- We have a <em>training</em> dataset containing some with input features <span class="math inline">\(X\)</span> and target labels/outcomes <span class="math inline">\(y\)</span><br>
- The algorithm learns a function <span class="math inline">\(f(X)\)</span> that predicts <span class="math inline">\(y\)</span> accurately<br>
- Learning is achieved by minimising a <em>cost</em> or <em>loss</em> function (i.e.&nbsp;an error metric that tells us how bad the predictions are compared to the observed <span class="math inline">\(y\)</span>)<br>
- Examples: <strong>Regression</strong> (continuous outcomes), <strong>Classification</strong> (categorical outcomes)</p>
</div>
<p>&nbsp;</p>
<div class="fragment">
<p><strong>Unsupervised Learning</strong><br>
- We only have input features <span class="math inline">\(X\)</span>, with no labeled outcome<br>
- The algorithm finds structure in the data (e.g., clusters, latent factors)<br>
- Much less well-defined problem since we don’t know usually know in advance what to look for.<br>
- Examples: <strong>Clustering</strong> (e.g., gaussian mixture models), <strong>Dimensionality Reduction</strong> (PCA)</p>
</div>
</section>
<section id="unsupervised-learning-some-examples" class="slide level2">
<h2>Unsupervised learning: some examples</h2>
<ul>
<li class="fragment"><p><strong>Clustering</strong><br>
Divides the training set into groups of similar examples. Each example should be more similar to examples in its group than to other groups.</p></li>
<li class="fragment"><p><strong>Dimensionality reduction</strong><br>
Transform high-dimensional data (e.g.&nbsp;many features/predictors) into a lower-dimensional representation that still retain some meaningful properties of original data.<br>
Example in psychology: exploratory factor analysis.</p></li>
<li class="fragment"><p><strong>Density estimation</strong><br>
Learn a probability distribution (probability <em>density</em> function or <em>pdf</em>) from data.</p></li>
<li class="fragment"><p><strong>Representation learning</strong><br>
Learn structured representations from raw data, often mapping high-dimensional categorical data into a continuous space.<br>
Example: large language models (LLM) like ChatGPT represent words as “dense vector embeddings” — sets of numbers that indicate where a word lies along different semantic dimensions.</p></li>
</ul>
</section>
<section id="section" class="slide level2">
<h2></h2>
<div>
<p><strong>Clustering examples:</strong></p>
<ul>
<li><strong>Personality types:</strong>
<ul>
<li>Identify distinct personality profiles based on questionnaire responses.</li>
<li>Example: clustering Big Five traits into personality “types.”</li>
</ul></li>
<li><strong>Mental health diagnostics:</strong>
<ul>
<li>Discover patient subgroups based on symptom patterns for tailored interventions.</li>
</ul></li>
<li><strong>Behavioral data segmentation:</strong>
<ul>
<li>Group participants based on response patterns or other measures.</li>
</ul></li>
</ul>
</div>
</section>
<section id="a-simple-clustering-algorithm-k-means" class="slide level2">
<h2>A simple clustering algorithm: <span class="math inline">\(k\)</span>-means</h2>
<ul>
<li class="fragment">Partition the data into <span class="math inline">\(k\)</span> categories (clusters).</li>
<li class="fragment">The “<span class="math inline">\(k\)</span>” denotes the requested number of clusters (a parameter that is set from the user).</li>
</ul>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size: 70%;">
<ul>
<li class="fragment"><p>Start by creating <span class="math inline">\(k\)</span> cluster at random, each defined by the coordinates of its mean value (<em>centroid</em>).</p></li>
<li class="fragment"><p>Alternate between two steps:</p>
<ol type="1">
<li class="fragment"><strong>Assignment step</strong>: assign each datapoint to the cluster with the nearest centroid.</li>
<li class="fragment"><strong>Update step</strong>: recalculate the mean (centroid) of each cluster from the datapoints assigned to it.</li>
</ol></li>
<li class="fragment"><p>Stop when the <em>cost</em> function — sum of within-cluster squared errors (distances from centroid) cannot be improved anymore.</p></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="K-means_convergence.gif" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div></div>
</div>
<aside class="notes">
<p>The k-means process is interrupted at each iteration after updating the means. The Voronoi cells (black lines) are drawn with the new means, but the points labels are still from the previous iteration (i.e.&nbsp;assigned to the closest mean of the previous iteration). This is why the black lines are already one iteration ahead (the Voronoi cells are only computed in visualization, k-means does not compute them). This can be a bit irritating, but it is a fact that the result, until converged, is never completely consistent: either points are not assigned to the nearest center, or the center is not the mean of the assigned points. Once we have both properties, it has converged.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="limitations-of-k-means-clustering" class="slide level2">
<h2>Limitations of <span class="math inline">\(k\)</span>-means clustering</h2>
<p>&nbsp;</p>
<ul>
<li class="fragment"><p><strong>“Hard” clustering method</strong>: each point is assigned to one and only one cluster; there is <em>no uncertainty measure</em> that tells us how confident we can be in the cluster assignment of each point.</p></li>
<li class="fragment"><p><strong>No flexibility in cluster’s shape</strong>: <span class="math inline">\(k\)</span>-means tend to find only clusters of similar shape and spatial extent</p></li>
</ul>
<div class="fragment">
<div style="font-size: 70%;">
<p>Other (less important) limitations of <span class="math inline">\(k\)</span>-means clustering are its sensitivity to initialization and to outliers.</p>
</div>
</div>
</section>
<section id="gaussian-mixture-models-gmm" class="slide level2">
<h2>Gaussian Mixture Models (GMM)</h2>
<ul>
<li class="fragment"><p>Some of these limitations can be overcome with a more sophisticated, <em>probabilistic</em> characterization of clusters.</p></li>
<li class="fragment"><p>In this approach, known as <em>mixture modelling</em> we assume that the data comes from a set of distinct sub-populations, each with its own characteristics. When these sub-populations are assumed to be Gaussian, we have a <em>Gaussian Mixture Model</em> or <em>GMM</em>.</p></li>
</ul>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Gaussian_Mixture.gif" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div>
</section>
<section id="gaussian-mixture-models-gmm-1" class="slide level2">
<h2>Gaussian Mixture Models (GMM)</h2>
<ul>
<li class="fragment"><p>For this to work, we need more than just a centroid to represent each cluster/sub-population:</p>
<ul>
<li class="fragment">the mean;</li>
<li class="fragment">the variance-covariance matrix</li>
</ul></li>
</ul>
</section>
<section id="gaussian-distribution-recap" class="slide level2" data-background-color="#202A30">
<h2>Gaussian distribution (recap)</h2>
<p>&nbsp;</p>
<p><strong>Simple <em>univariate</em> Gaussian distribution</strong></p>
<p>&nbsp;</p>
<div class="fragment">
<p>Unbounded, bell-shaped distribution, characterised by two parameters: the mean (<span class="math inline">\(\mu\)</span>) and the standard deviation (<span class="math inline">\(\sigma\)</span>)</p>
</div>
<p>&nbsp;</p>
<div class="columns">
<div class="column" style="width:50%;">
<p>&nbsp; &nbsp; &nbsp;</p>
<div class="fragment">
<p><span class="math inline">\(x \sim \mathcal{N}(\mu=1, \sigma=2)\)</span></p>
</div>
<p>&nbsp; &nbsp; &nbsp;</p>
<div class="fragment">
<p><span class="math inline">\(p(x) =  \frac{1}{\sigma \sqrt{2 \pi}} e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2}\)</span></p>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="unsupervised_GMM_files/figure-revealjs/unnamed-chunk-1-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div></div>
</section>
<section id="gaussian-distribution-recap-1" class="slide level2" data-background-color="#202A30">
<h2>Gaussian distribution (recap)</h2>
<p>&nbsp;</p>
<p><strong><em>Multivariate</em> Gaussian distribution</strong></p>
<p>A generalization of the Gaussian distribution to data with more than one dimension/component:</p>
<ul>
<li class="fragment"><p>Each datapoint is represented as a vector, i.e., an ordered set of numbers (one for each dimension).</p></li>
<li class="fragment"><p>Each dimension/component has its own mean.</p></li>
<li class="fragment"><p>Instead of a single standard deviation, we use a variance-covariance matrix, which specifies:</p>
<ul>
<li class="fragment">the variance (spread) for each dimension,</li>
<li class="fragment">the covariance (correlation) between dimensions.</li>
</ul></li>
</ul>
</section>
<section id="section-1" class="slide level2 scrollable" data-background-color="#202A30" data-transition="slide">
<h2></h2>
<p><strong>Variance-covariance matrix example:</strong></p>
<p>&nbsp;</p>
<p>For a bivariate Gaussian (2 components, <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>), <span class="math inline">\(\left[x_1, x_2 \right] \sim \mathcal{N}(\left[\mu_1, \mu_2\right], \Omega)\)</span>, we have a 2-by-2 variance-covariance matrix:</p>
<p>&nbsp;</p>
<div class="fragment">
<p><span class="math display">\[\Omega = \left[ \begin{array}{cc} \text{Var}(x_1) &amp; \text{Cov}(x_1, x_2) \\ \text{Cov}(x_1, x_2) &amp; \text{Var}(x_2) \end{array} \right]\]</span></p>
</div>
<p>&nbsp;</p>
<div class="fragment">
<div style="font-size: 70%;">
<p>where:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(\text{Var}(x) = \sigma_{x}^2\)</span></p></li>
<li class="fragment"><p><span class="math inline">\(\text{Cov}(x_1, x_2) = \rho \,\sigma_{x_1}\sigma_{x_2}\)</span>, that is the covariance can be represented as the product of the 2 standard deviations, multiplied by a correlation coefficient <span class="math inline">\(\rho\)</span>.</p></li>
</ul>
</div>
</div>
<p>&nbsp;</p>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="unsupervised_GMM_files/figure-revealjs/unnamed-chunk-2-1.png" class="quarto-figure quarto-figure-center" width="864"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="gaussian-mixture-models-gmm-2" class="slide level2">
<h2>Gaussian Mixture Models (GMM)</h2>
<ul>
<li class="fragment"><p>Each “cluster” is modelled as a Gaussian sub-population with its own <strong>mean</strong> vector and <strong>variance-covariance matrix</strong>.</p></li>
<li class="fragment"><p>Each component (sub-population) has a <strong>mixture weight</strong>, which indicates the probability that a randomly selected datapoint belongs to that particular sub-population.</p></li>
<li class="fragment"><p>Some advantages over <span class="math inline">\(k\)</span>-means are:</p>
<ul>
<li class="fragment">Flexibility in shape: Clusters can vary in size, shape, and orientation.</li>
<li class="fragment">Soft cluster assignments: No hard boundaries between clusters. Sub-populations can overlap substantially, and each datapoint can have partial membership in multiple clusters (probabilistic assignment).</li>
</ul></li>
<li class="fragment"><p>A GMM provides, for each datapoint, a vector of probabilities representing how likely it is that the it belongs to each cluster (to obtain a “hard assignment” we can pick the highest probability)</p></li>
</ul>
</section>
<section id="number-of-clusters-model-selection-in-gmm" class="slide level2">
<h2>Number of clusters &amp; model selection in GMM</h2>
<ul>
<li class="fragment"><p>A key challenge in Gaussian mixture modeling (GMM) is deciding how many clusters to use.</p></li>
<li class="fragment"><p>In addition, we must choose a suitable covariance structure for the clusters.</p>
<ul>
<li class="fragment">For instance, clusters may be assumed spherical (uncorrelated), or to share the same variance (more details later).</li>
</ul></li>
<li class="fragment"><p>GMM addresses these choices automatically through model selection criteria.</p></li>
<li class="fragment"><p>The Bayesian Information Criterion (<strong>BIC</strong>) is most commonly used:</p>
<ul>
<li class="fragment">Models with different numbers of clusters are compared.</li>
<li class="fragment">The model with the best BIC score is typically selected as the optimal solution.</li>
</ul></li>
</ul>
</section>
<section id="gaussian-mixture-model-in-r-mclust-package" class="slide level2">
<h2>Gaussian Mixture Model in R: <code>mclust</code> package</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">library</span>(mclust)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>&nbsp;</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:40%;">
<p>Example “mouse” dataset (available on Moodle)</p>
<p>&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"mouse.csv"</span>)</span>
<span id="cb2-2"><a href=""></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        X1       X2
1 3.566276 8.057792
2 7.988349 4.153911
3 4.368442 5.601580
4 2.763622 7.454118
5 6.174496 4.262424
6 8.048162 7.815795</code></pre>
</div>
</div>
</div><div class="column" style="width:60%;">
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="unsupervised_GMM_files/figure-revealjs/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</div></div>
</div>
</section>
<section id="gmm-with-mclust" class="slide level2">
<h2>GMM with <code>mclust</code></h2>
<p>&nbsp;</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a>fit <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(dat)    <span class="co"># fit GMM</span></span>
<span id="cb4-2"><a href=""></a><span class="fu">summary</span>(fit)          <span class="co"># print summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>---------------------------------------------------- 
Gaussian finite mixture model fitted by EM algorithm 
---------------------------------------------------- 

Mclust VII (spherical, varying volume) model with 3 components: 

 log-likelihood   n df       BIC       ICL
      -3430.111 900 11 -6935.048 -7007.034

Clustering table:
  1   2   3 
148 592 160 </code></pre>
</div>
</div>
</div>
</section>
<section id="section-2" class="slide level2 scrollable">
<h2></h2>
<p>As it is often the case, <code>summary()</code> only print key information, there is a lot more in the fitted model object. Using the <code>str()</code> is one way to get a list of what is included:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="fu">str</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 16
 $ call          : language Mclust(data = dat)
 $ data          : num [1:900, 1:2] 3.57 7.99 4.37 2.76 6.17 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : NULL
  .. ..$ : chr [1:2] "X1" "X2"
 $ modelName     : chr "VII"
 $ n             : int 900
 $ d             : int 2
 $ G             : int 3
 $ BIC           : 'mclustBIC' num [1:9, 1:14] -7552 -7565 -7321 -7287 -7201 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:9] "1" "2" "3" "4" ...
  .. ..$ : chr [1:14] "EII" "VII" "EEI" "VEI" ...
  ..- attr(*, "G")= num [1:9] 1 2 3 4 5 6 7 8 9
  ..- attr(*, "modelNames")= chr [1:14] "EII" "VII" "EEI" "VEI" ...
  ..- attr(*, "control")=List of 4
  .. ..$ eps     : num 2.22e-16
  .. ..$ tol     : num [1:2] 1.00e-05 1.49e-08
  .. ..$ itmax   : int [1:2] 2147483647 2147483647
  .. ..$ equalPro: logi FALSE
  ..- attr(*, "initialization")=List of 3
  .. ..$ hcPairs: 'hc' num [1:2, 1:899] 324 636 324 677 324 890 324 577 324 613 ...
  .. .. ..- attr(*, "initialPartition")= num [1:900] 1 2 3 4 5 6 7 8 9 10 ...
  .. .. .. ..- attr(*, "unique")= int 900
  .. .. ..- attr(*, "dimensions")= int [1:2] 900 2
  .. .. ..- attr(*, "modelName")= chr "VVV"
  .. .. ..- attr(*, "call")= language hc(data = data, modelName = mclust.options("hcModelName"), use = mclust.options("hcUse"))
  .. .. ..- attr(*, "use")= chr "SVD"
  .. .. ..- attr(*, "data")= num [1:900, 1:2] 0.0103 0.0456 -0.0975 -0.0818 -0.0664 ...
  .. ..$ subset : NULL
  .. ..$ noise  : NULL
  ..- attr(*, "warn")= logi FALSE
  ..- attr(*, "n")= int 900
  ..- attr(*, "d")= int 2
  ..- attr(*, "oneD")= logi FALSE
  ..- attr(*, "criterion")= chr "BIC"
  ..- attr(*, "returnCodes")= num [1:9, 1:14] 0 0 0 0 0 0 0 0 0 0 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:9] "1" "2" "3" "4" ...
  .. .. ..$ : chr [1:14] "EII" "VII" "EEI" "VEI" ...
 $ loglik        : num -3430
 $ df            : num 11
 $ bic           : num -6935
 $ icl           : num -7007
 $ hypvol        : num NA
 $ parameters    :List of 3
  ..$ pro     : num [1:3] 0.158 0.674 0.168
  ..$ mean    : num [1:2, 1:3] 2.98 8.02 5.45 4.98 8.03 ...
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ : chr [1:2] "X1" "X2"
  .. .. ..$ : NULL
  ..$ variance:List of 6
  .. ..$ modelName: chr "VII"
  .. ..$ d        : int 2
  .. ..$ G        : int 3
  .. ..$ sigma    : num [1:2, 1:2, 1:3] 0.27 0 0 0.27 2.53 ...
  .. .. ..- attr(*, "dimnames")=List of 3
  .. .. .. ..$ : chr [1:2] "X1" "X2"
  .. .. .. ..$ : chr [1:2] "X1" "X2"
  .. .. .. ..$ : NULL
  .. ..$ sigmasq  : num [1:3] 0.27 2.534 0.295
  .. ..$ scale    : num [1:3] 0.27 2.534 0.295
 $ z             : num [1:900, 1:3] 9.39e-01 8.46e-32 1.86e-06 9.40e-01 9.57e-20 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : NULL
  .. ..$ : NULL
 $ classification: num [1:900] 1 2 2 1 2 3 1 2 3 3 ...
 $ uncertainty   : num [1:900] 6.05e-02 1.48e-10 1.86e-06 5.97e-02 5.31e-13 ...
 - attr(*, "class")= chr "Mclust"</code></pre>
</div>
</div>
</section>
<section id="section-3" class="slide level2 scrollable">
<h2></h2>
<p>The field <code>fit$classification</code> contains the “hard” assignment of data-points to clusters.</p>
<p>&nbsp;</p>
<div class="fragment">
<p>The field <code>fit$z</code> contains the probabilities that each datapoint belong to each cluster</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="fu">head</span>(fit<span class="sc">$</span>z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             [,1]       [,2]         [,3]
[1,] 9.394938e-01 0.06050619 4.020001e-15
[2,] 8.456048e-32 1.00000000 1.484083e-10
[3,] 1.859867e-06 0.99999814 2.867654e-14
[4,] 9.402792e-01 0.05972083 4.911272e-21
[5,] 9.571797e-20 1.00000000 5.311986e-13
[6,] 2.760140e-21 0.02562377 9.743762e-01</code></pre>
</div>
</div>
</div>
<p>&nbsp;</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">round</span>(<span class="fu">head</span>(fit<span class="sc">$</span>z), <span class="at">digits=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]   [,2]   [,3]
[1,] 0.9395 0.0605 0.0000
[2,] 0.0000 1.0000 0.0000
[3,] 0.0000 1.0000 0.0000
[4,] 0.9403 0.0597 0.0000
[5,] 0.0000 1.0000 0.0000
[6,] 0.0000 0.0256 0.9744</code></pre>
</div>
</div>
</div>
</section>
<section id="visualising-results" class="slide level2">
<h2>Visualising results</h2>
<p>&nbsp;</p>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="co"># Add predicted cluster to the dataset</span></span>
<span id="cb12-2"><a href=""></a>dat<span class="sc">$</span>cluster_gmm <span class="ot">&lt;-</span> <span class="fu">factor</span>(fit<span class="sc">$</span>classification)</span>
<span id="cb12-3"><a href=""></a></span>
<span id="cb12-4"><a href=""></a><span class="co"># Plot GMM results</span></span>
<span id="cb12-5"><a href=""></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, </span>
<span id="cb12-6"><a href=""></a>                <span class="at">color =</span> cluster_gmm)) <span class="sc">+</span></span>
<span id="cb12-7"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href=""></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-9"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"GMM xlustering"</span>,</span>
<span id="cb12-10"><a href=""></a>       <span class="at">x =</span> <span class="st">"X1"</span>, <span class="at">y =</span> <span class="st">"X2"</span>,</span>
<span id="cb12-11"><a href=""></a>       <span class="at">color =</span> <span class="st">"cluster"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="unsupervised_GMM_files/figure-revealjs/unnamed-chunk-11-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="comparison-with-k-means" class="slide level2">
<h2>Comparison with <span class="math inline">\(k\)</span>-means</h2>
<p>&nbsp;</p>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="co"># Perform k-means clustering (3 clusters)</span></span>
<span id="cb13-2"><a href=""></a>kmeans_fit <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(dat, </span>
<span id="cb13-3"><a href=""></a>                     <span class="at">centers =</span> <span class="dv">3</span>)</span>
<span id="cb13-4"><a href=""></a></span>
<span id="cb13-5"><a href=""></a><span class="co"># Add predicted cluster to the dataset</span></span>
<span id="cb13-6"><a href=""></a>dat<span class="sc">$</span>cluster_kmeans <span class="ot">&lt;-</span> <span class="fu">factor</span>(kmeans_fit<span class="sc">$</span>cluster)</span>
<span id="cb13-7"><a href=""></a></span>
<span id="cb13-8"><a href=""></a><span class="co"># Plot k-means results</span></span>
<span id="cb13-9"><a href=""></a><span class="fu">ggplot</span>(dat, </span>
<span id="cb13-10"><a href=""></a>       <span class="fu">aes</span>(<span class="at">x =</span> X1, <span class="at">y =</span> X2, </span>
<span id="cb13-11"><a href=""></a>           <span class="at">color =</span> cluster_kmeans)) <span class="sc">+</span></span>
<span id="cb13-12"><a href=""></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb13-13"><a href=""></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-14"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"K-means Clustering"</span>,</span>
<span id="cb13-15"><a href=""></a>       <span class="at">x =</span> <span class="st">"X1"</span>, <span class="at">y =</span> <span class="st">"X2"</span>,</span>
<span id="cb13-16"><a href=""></a>       <span class="at">color =</span> <span class="st">"cluster"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="unsupervised_GMM_files/figure-revealjs/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="model-selection-in-mclust" class="slide level2">
<h2>Model selection in <code>mclust</code></h2>
<p>By default, <code>mclust</code> tries all parametrizations of variance-covariance matrix, and up to 9 components</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a>fit<span class="sc">$</span>BIC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayesian Information Criterion (BIC): 
        EII       VII       EEI       VEI       EVI       VVI       EEE
1 -7551.993 -7551.993 -7558.775 -7558.775 -7558.775 -7558.775 -7565.180
2 -7565.119 -7278.653 -7490.524 -7281.517 -7497.973 -7286.082 -7463.134
3 -7320.692 -6935.048 -7327.459 -6941.833 -7294.907 -6953.556 -7334.256
4 -7286.880 -6960.094 -7266.353 -6966.290 -7259.291 -6986.346 -7244.108
5 -7200.874 -6985.576 -7206.346 -6991.876 -7218.239 -7018.360 -7213.405
6 -7144.827 -7003.755 -7151.442 -7010.151 -7174.953 -7040.426 -7158.099
7 -7165.264 -7028.188 -7171.887 -7033.499 -7201.834 -7071.017 -7178.494
8 -7160.411 -7053.046 -7166.847 -7059.154 -7218.390 -7104.762 -7169.938
9 -7133.254 -7071.940 -7132.348 -7077.232 -7154.250 -7118.450 -7135.946
        VEE       EVE       VVE       EEV       VEV       EVV       VVV
1 -7565.180 -7565.180 -7565.180 -7565.180 -7565.180 -7565.180 -7565.180
2 -7208.383 -7436.430 -7203.606 -7345.224 -7212.119 -7351.503 -7209.669
3 -6948.534 -7295.650 -6959.817 -7271.455 -6960.199 -7261.075 -6973.171
4 -6972.955 -7229.232 -6993.628 -7225.750 -6992.850 -7240.081 -7012.560
5 -6998.249 -7216.935 -7023.065 -7214.273 -7024.058 -7184.379 -7049.712
6 -7016.348 -7170.415 -7041.071 -7181.320 -7047.370 -7205.852 -7073.190
7 -7039.644 -7206.070 -7072.414 -7207.707 -7077.117 -7231.924 -7116.035
8 -7065.124 -7177.877 -7100.918 -7172.031 -7109.289 -7212.995 -7146.980
9 -7083.531 -7183.268 -7132.322 -7187.962 -7135.627 -7179.092 -7171.743

Top 3 models based on the BIC criterion: 
    VII,3     VEI,3     VEE,3 
-6935.048 -6941.833 -6948.534 </code></pre>
</div>
</div>
</section>
<section id="visualising-model-selection-in-mclust" class="slide level2">
<h2>Visualising model selection in <code>mclust</code></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a><span class="fu">plot</span>(fit<span class="sc">$</span>BIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="unsupervised_GMM_files/figure-revealjs/unnamed-chunk-15-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="understanding-variance-covariance-parametrization" class="slide level2">
<h2>Understanding variance-covariance parametrization</h2>
<p>&nbsp;</p>
<div>
<p>The type of model is identified by 3 letters, and their orders refer to the 3 main properties:</p>
<ul>
<li><strong>1st letter</strong> → <strong>Volume</strong> (overall size of the clusters)</li>
<li><strong>2nd letter</strong> → <strong>Shape</strong> (ratios between cluster axes, or the “elongation”)</li>
<li><strong>3rd letter</strong> → <strong>Orientation</strong> (direction of the ellipsoid in space)</li>
</ul>
<p>Each characteristic can be either:</p>
<ul>
<li><strong>E (<em>Equal</em>)</strong>: identical across clusters</li>
<li><strong>V (<em>Variable</em>)</strong>: different for each cluster</li>
<li><strong>I (<em>Identity</em>)</strong>: restricted (spherical, no elongation or rotation), meaning spherical clusters.</li>
</ul>
</div>
<p>&nbsp;</p>
<div class="fragment">
<div style="font-size: 70%;">
<p>For example, the model labelled <strong>EEI</strong> would be the most similar to <span class="math inline">\(k\)</span>-means, as it correspond to <em>spherical clusters with equal variance across dimensions.</em></p>
</div>
</div>
</section>
<section id="gmm-with-more-than-2-dimensions" class="slide level2 scrollable">
<h2>GMM with more than 2 dimensions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb17-2"><a href=""></a><span class="fu">str</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [344 × 8] (S3: tbl_df/tbl/data.frame)
 $ species          : Factor w/ 3 levels "Adelie","Chinstrap",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ island           : Factor w/ 3 levels "Biscoe","Dream",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ bill_length_mm   : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...
 $ bill_depth_mm    : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...
 $ flipper_length_mm: int [1:344] 181 186 195 NA 193 190 181 195 193 190 ...
 $ body_mass_g      : int [1:344] 3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...
 $ sex              : Factor w/ 2 levels "female","male": 2 1 1 NA 1 2 1 2 NA NA ...
 $ year             : int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a>dat <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(penguins[, <span class="fu">c</span>(<span class="st">"species"</span>, <span class="st">"bill_length_mm"</span>, <span class="st">"flipper_length_mm"</span>, <span class="st">"body_mass_g"</span>)])</span>
<span id="cb19-2"><a href=""></a>fit <span class="ot">&lt;-</span> <span class="fu">Mclust</span>(dat[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb19-3"><a href=""></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>---------------------------------------------------- 
Gaussian finite mixture model fitted by EM algorithm 
---------------------------------------------------- 

Mclust EEE (ellipsoidal, equal volume, shape and orientation) model with 3
components: 

 log-likelihood   n df       BIC       ICL
      -4751.497 342 17 -9602.185 -9620.434

Clustering table:
  1   2   3 
155  60 127 </code></pre>
</div>
</div>
</section>
<section id="gmm-with-more-than-2-dimensions-1" class="slide level2">
<h2>GMM with more than 2 dimensions</h2>
<p>Using bill length, flipper length and body mass suggest 3 classes; we can plot the results as follow:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="fu">plot</span>(fit, <span class="at">what =</span> <span class="st">"classification"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="unsupervised_GMM_files/figure-revealjs/unnamed-chunk-17-1.png" class="quarto-figure quarto-figure-center r-stretch" width="528"></section>
<section id="gmm-with-more-than-2-dimensions-2" class="slide level2">
<h2>GMM with more than 2 dimensions</h2>
<p>The <code>mclust</code> package contains also some handy functions to visualise the ‘true’ class (if available)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a><span class="fu">clPairs</span>(dat[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">classification=</span>dat<span class="sc">$</span>species, </span>
<span id="cb22-2"><a href=""></a>        <span class="at">main=</span><span class="st">"True penguin species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="unsupervised_GMM_files/figure-revealjs/unnamed-chunk-18-1.png" class="quarto-figure quarto-figure-center r-stretch" width="624"></section>
<section id="exercise" class="slide level2">
<h2>Exercise</h2>
<div>
<ul>
<li>Use one of the dataset for clustering in the ‘coursework’ folder on Moodle and fit and evaluate a GMM model.</li>
</ul>
</div>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="unsupervised_GMM_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="unsupervised_GMM_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="unsupervised_GMM_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="unsupervised_GMM_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="unsupervised_GMM_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="unsupervised_GMM_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="unsupervised_GMM_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="unsupervised_GMM_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="unsupervised_GMM_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="unsupervised_GMM_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>